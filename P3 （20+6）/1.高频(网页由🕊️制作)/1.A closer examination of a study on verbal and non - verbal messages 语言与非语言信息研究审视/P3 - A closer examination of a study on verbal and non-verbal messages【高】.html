<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>A closer examination of a study on verbal and non-verbal messages</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  :root { 
    --line:#e5e7eb; 
    --bg:#f6f7fb; 
    --panel:#fff; 
    --accent:#3b82f6; 
    --muted:#6b7280; 
    --shadow:0 6px 20px rgba(0,0,0,.12); 
  }
  * { box-sizing: border-box; }
  html,body { height:100%; }
  body { 
    margin:0; 
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; 
    background:var(--bg); 
    padding-bottom: 82px; 
  }
  
  /* Â∏ÉÂ±ÄÊ†∑Âºè */
  .shell { display:flex; height:100vh; width:100%; }
  .pane { background:var(--panel); overflow:auto; padding:20px; }
  #left { flex: 0 0 50%; min-width: 280px; }
  #right { flex: 1 1 auto; min-width: 320px; background:#fbfbff; border-left:1px solid var(--line); }
  #divider { flex: 0 0 8px; background: linear-gradient(90deg,#e5e7eb,#d1d5db); cursor: ew-resize; position:relative; z-index: 5; user-select:none; }
  
  /* ÊñáÊú¨Ê†∑Âºè */
  h2,h3,h4 { margin:0 0 10px; }
  #left p { margin: 0 0 12px; line-height: 1.6; word-break: normal; overflow-wrap: normal; hyphens: none; }
  
  /* ÁªÑ‰ª∂Ê†∑Âºè */
  .group { background:#fff; border:1px solid var(--line); border-radius:10px; padding:12px; margin-bottom:14px; }
  input.blank { 
    border:none; 
    border-bottom:1px solid #9ca3af; 
    padding:2px 4px; 
    font-size:1em; 
    background:transparent; 
    min-width: 80px;
  }
  input.blank:focus { outline:none; border-bottom:2px solid var(--accent); }
  
  /* ÊåâÈíÆÊ†∑Âºè */
  button { 
    padding:8px 12px; 
    border:1px solid var(--line); 
    background:#fff; 
    border-radius:6px; 
    cursor:pointer; 
    transition:all 0.2s; 
    font-size:14px; 
  }
  button:hover { background:#f8fafc; border-color:#cbd5e1; }
  button.primary { 
    background:var(--accent); 
    color:#fff; 
    border-color:var(--accent); 
  }
  button.primary:hover { background:#2563eb; }
  
  /* ËÆ°Êó∂Âô®Ê†∑Âºè */
  #timer { 
    background:#fff; 
    color:var(--muted); 
    border:1px solid var(--line); 
    border-radius:6px; 
    padding:6px 12px; 
    cursor:pointer; 
    font-family: 'Courier New', monospace; 
    transition:all 0.2s; 
    min-width: 70px;
    text-align: center;
    font-size: 18px;
    font-weight: bold;
  }
  #timer:hover { 
    background:#f1f5f9; 
    border-color:var(--accent); 
  }
  #timer.paused { 
    color: #ef4444; 
    border-color: #fecaca; 
    background: #fef2f2; 
  }
  
  /* ‰∏ªÈ¢òÂàáÊç¢ÊåâÈíÆ */
  .theme-toggle { 
    background:#fff; 
    color:var(--muted); 
    border:1px solid var(--line); 
    border-radius:6px; 
    width: 36px;
    height: 36px;
    font-size: 16px;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .theme-toggle:hover {
    background: var(--accent);
    color: #fff;
    border-color: var(--accent);
    transform: scale(1.05);
  }
  .theme-toggle:active {
    transform: scale(0.95);
  }
  
  /* ÊãñÊãΩÁõ∏ÂÖ≥Ê†∑Âºè */
  .dropzone { 
    border:2px dashed #cbd5e1; 
    background:#f8fafc; 
    border-radius:10px; 
    min-height:54px; 
    padding:8px; 
    display:flex; 
    align-items:center; 
    justify-content:space-between; 
    gap:8px; 
  }
  .droplabel { color:#64748b; }
  .cardpool { 
    background:#f1f5f9; 
    border-radius:10px; 
    padding:12px; 
    display:grid; 
    gap:8px; 
  }
  .pool-slot { min-height:40px; }
  .card { 
    background:#fff; 
    border:1px solid #e5e7eb; 
    border-radius:8px; 
    padding:8px 10px; 
    display:inline-flex; 
    gap:8px; 
    align-items:center; 
    cursor:grab; 
    box-shadow:0 1px 0 rgba(0,0,0,.03); 
  }
  .card:active { cursor:grabbing; }
  .tag { 
    background:#eef2ff; 
    color:#4338ca; 
    padding:2px 8px; 
    border-radius:999px; 
    font-size:12px; 
  }
  .btn-clear { 
    border:1px solid #e5e7eb; 
    background:#fff; 
    border-radius:8px; 
    padding:6px 8px; 
    cursor:pointer; 
  }
  .ghost { opacity: .5; }
  .over { outline:2px dashed #3b82f6; }
  
  /* Ê∑±Ëâ≤Ê®°ÂºèÊ†∑Âºè */
  body.dark { 
    --bg: #0f172a; 
    --panel: #1e293b; 
    --line: #334155; 
    --muted: #94a3b8; 
    color: #e2e8f0; 
  }
  body.dark #right { background: #0f172a; }
  body.dark .group { background: #1e293b; border-color: #334155; }
  body.dark button { background: #1e293b; color: #e2e8f0; border-color: #334155; }
  body.dark button:hover { background: #334155; }
  body.dark button.primary { background: var(--accent); color: #fff; }
  body.dark #results { background: #1e293b; border-color: #334155; }
  body.dark #notes { background: #1e293b; border-color: #334155; color: #e2e8f0; }
  body.dark .practice-nav { background: #1e293b; border-color: #334155; }
  body.dark .q-item { background: #0f172a; color: #e2e8f0; border-color: #334155; }
  body.dark .q-item:hover { background: #334155; }
  body.dark .q-item.answered { background: #1e40af; border-color: var(--accent); color: #93c5fd; }
  body.dark #timer { background: #1e293b; color: #e2e8f0; border-color: #334155; }
  body.dark #timer:hover { background: #334155; border-color: var(--accent); }
  body.dark details.answerbox { background: #1e293b; border-color: #334155; }
  body.dark input.blank { color: #e2e8f0; border-bottom-color: #64748b; }
  body.dark input.blank:focus { border-bottom-color: var(--accent); }
  body.dark .cardpool { background:#1e293b; }
  body.dark .card { background:#334155; border-color: #475569; }
  body.dark .dropzone { background:#1e293b; border-color: #475569; }
  body.dark .tag { background:#334155; color:#93c5fd; }
  body.dark .btn-clear { background:#334155; border-color: #475569; }
  
  /* ÂìçÂ∫îÂºèËÆæËÆ° */
  @media (max-width: 768px) {
    .shell { flex-direction: column; }
    #left, #right { flex: none; min-width: auto; }
    #divider { display: none; }
    .practice-nav .controls { gap: 8px; }
    #timer { font-size: 12px; padding: 3px 8px; }
    .theme-toggle { width: 32px; height: 32px; font-size: 14px; }
    #notes { width: calc(100vw - 24px); right: 12px; left: 12px; }
  }
  
  /* ÈÄâÊã©Â∑•ÂÖ∑Ê†è */
  #selbar { 
    position: fixed; 
    display:none; 
    z-index: 2000; 
    background:#111; 
    color:#fff; 
    border-radius: 8px; 
    padding: 6px; 
    box-shadow: var(--shadow); 
    font-size: 13px; 
    gap:6px; 
    align-items: center; 
  }
  #selbar button { 
    background: transparent; 
    color:#fff; 
    border: 1px solid rgba(255,255,255,.25); 
    padding: 4px 8px; 
    border-radius: 6px; 
    cursor:pointer; 
  }
  #selbar button:hover { border-color:#fff; }
  
  /* Á¨îËÆ∞Èù¢Êùø */
  #notes { 
    position: fixed; 
    right: 12px; 
    bottom: 12px; 
    width: 320px; 
    height: 42vh; 
    background:#fff; 
    border:1px solid var(--line); 
    border-radius: 12px; 
    display:none; 
    flex-direction: column; 
    z-index:1500; 
    box-shadow: var(--shadow); 
  }
  #notes header { 
    display:flex; 
    align-items:center; 
    justify-content: space-between; 
    padding:8px 10px; 
    border-bottom:1px solid var(--line); 
  }
  #notes textarea { 
    flex:1; 
    border:0; 
    padding:10px; 
    resize:none; 
    font-size:14px; 
    line-height:1.5; 
  }
  
  /* ToastÈÄöÁü• */
  #toast { 
    position: fixed; 
    bottom: 20px; 
    left: 50%; 
    transform: translateX(-50%); 
    background: rgba(0,0,0,0.8); 
    color: #fff; 
    padding: 8px 16px; 
    border-radius: 4px; 
    display: none; 
    z-index: 3000; 
    font-size: 14px; 
  }
  
  /* Á≠îÈ¢òÂØºËà™ */
  .practice-nav { 
    background:#fff; 
    padding:12px 20px; 
    display:flex; 
    align-items:center; 
    gap:16px; 
    box-shadow:0 2px 4px rgba(0,0,0,.05); 
    flex-wrap:wrap; 
    position:fixed; 
    left:0; 
    right:0; 
    bottom:0; 
    border-top:2px solid var(--line); 
    z-index:4000; 
  }
  .practice-nav .title { font-weight:600; color:var(--muted); }
  .practice-nav .questions { 
    display:flex; 
    gap:8px; 
    align-items:center; 
    flex-wrap:wrap; 
  }
  .practice-nav .q-item { 
    padding:6px 10px; 
    border:1px solid var(--line); 
    border-radius:6px; 
    background:#fff; 
    cursor:pointer; 
    font-size:14px; 
    transition:all 0.2s; 
    min-width:36px; 
    text-align:center; 
  }
  .practice-nav .q-item:hover { 
    background:#f1f5f9; 
    border-color:var(--accent); 
  }
  .practice-nav .q-item.answered { 
    background:#e0e7ff; 
    border-color:var(--accent); 
    color:var(--accent); 
    font-weight:500; 
  }
  .practice-nav .q-item.active { 
    background:var(--accent); 
    color:#fff; 
  }
  .practice-nav .controls { 
    display:flex; 
    gap:12px; 
    margin-left:auto; 
    align-items:center; 
  }
  
  /* Á≠îÈ¢òÁªìÊûúÊòæÁ§∫ */
  #results { 
    background:#fff; 
    border:1px solid var(--line); 
    border-radius:10px; 
    padding:12px; 
    margin:16px 0; 
    font-family: monospace; 
    white-space:pre-wrap; 
  }
  #results p { margin:0 0 8px; }
  .badge { 
    background:#e0e7ff; 
    color:var(--accent); 
    padding:2px 8px; 
    border-radius:999px; 
    font-size:12px; 
  }
  
  /* Á≠îÊ°àÊ°Ü */
  details.answerbox { 
    background:#fff; 
    border:1px solid var(--line); 
    border-radius:10px; 
    padding:12px; 
    margin-top:10px; 
  }
  details.answerbox summary { 
    cursor:pointer; 
    font-weight:600; 
    list-style:none; 
    display:flex; 
    align-items:center; 
    justify-content:space-between; 
  }
  details.answerbox summary::-webkit-details-marker { display:none; }
  #answerContent { margin-top:10px; }
  #answerContent ol { margin:0; padding-left:20px; }
  #answerContent li { margin:4px 0; }
  
  /* È´ò‰∫ÆÊ†∑Âºè */
  .hl { background: #ffeb3b; color: #000; }
  body.dark .hl { background: #8a6d00; color: #fff; }
  
  /* ÊªöÂä®Êù°Ê†∑Âºè */
  ::-webkit-scrollbar { width: 8px; height: 8px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: #c5c5d2; border-radius: 4px; }
  ::-webkit-scrollbar-thumb:hover { background: #999; }
  body.dark ::-webkit-scrollbar-thumb { background: #4a5568; }
  body.dark ::-webkit-scrollbar-thumb:hover { background: #718096; }
  
  table { border-collapse: collapse; width:100%; }
  th, td { border:1px solid var(--line); padding:6px; text-align:center; font-size:14px; }
  th:first-child, td:first-child { width:92px; }
</style>
</head>
<body>

<div class="practice-nav">
  <div class="title">Questions</div>
  <div class="questions">
    <div class="q-item" id="q27-nav" onclick="scrollToElement('q27-anchor')">27</div>
    <div class="q-item" id="q28-nav" onclick="scrollToElement('q28-anchor')">28</div>
    <div class="q-item" id="q29-nav" onclick="scrollToElement('q29-anchor')">29</div>
    <div class="q-item" id="q30-nav" onclick="scrollToElement('q30-anchor')">30</div>
    <div class="q-item" id="q31-nav" onclick="scrollToElement('q31-anchor')">31</div>
    <div class="q-item" id="q32-nav" onclick="scrollToElement('q32-anchor')">32</div>
    <div class="q-item" id="q33-nav" onclick="scrollToElement('q33-anchor')">33</div>
    <div class="q-item" id="q34-nav" onclick="scrollToElement('q34-anchor')">34</div>
    <div class="q-item" id="q35-nav" onclick="scrollToElement('q35-anchor')">35</div>
    <div class="q-item" id="q36-nav" onclick="scrollToElement('q36-anchor')">36</div>
    <div class="q-item" id="q37-nav" onclick="scrollToElement('q37-anchor')">37</div>
    <div class="q-item" id="q38-nav" onclick="scrollToElement('q38-anchor')">38</div>
    <div class="q-item" id="q39-nav" onclick="scrollToElement('q39-anchor')">39</div>
    <div class="q-item" id="q40-nav" onclick="scrollToElement('q40-anchor')">40</div>
  </div>
  <div class="controls">
    <span id="timer" onclick="toggleTimer()">00:00</span>
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark mode">üåô</button>
  </div>
</div>

<div class="shell">
  <section class="pane" id="left">
    <h2>READING PASSAGE 3</h2>
    <p>You should spend about 20 minutes on Questions 27‚Äì40, which are based on Reading Passage 3 below.</p>
    <h3>A closer examination of a study on verbal and non-verbal messages</h3>
    
    <h4>Paragraph A</h4>
    <p>Throughout history, people have attempted to understand how communication works. Aristotle developed one of the first communication theories, suggesting that a speaker needed to be credible, appealing, and logical to be persuasive. However, his model only considered verbal messages. It wasn't until the 20th century that communication scholars began to seriously consider non-verbal messages. One of the most influential early studies in this area was conducted by Albert Mehrabian in the 1960s. His research suggested that when a person's verbal and non-verbal messages conflict, people tend to believe the non-verbal message 55% of the time, while vocal elements (such as tone of voice) account for 38%, and actual words only 7%.</p>
    
    <h4>Paragraph B</h4>
    <p>Mehrabian's study has been widely cited and often misinterpreted. Many people have taken his findings to mean that non-verbal communication is always more important than verbal communication, regardless of the context. This interpretation has led to the popular belief that we communicate more through body language than through words. However, Mehrabian himself has repeatedly clarified that his findings only apply to situations where there is a contradiction between verbal and non-verbal messages, and where the communication is about feelings and attitudes. His research did not suggest that non-verbal communication is more important in all situations.</p>
    
    <h4>Paragraph C</h4>
    <p>Mehrabian's research involved two separate studies. In the first study, participants were asked to judge the attitudes of a speaker based on photographs of facial expressions. In the second study, participants listened to recordings of words spoken with different tones of voice. The research was conducted in a laboratory setting, with controlled conditions that may not reflect real-world communication. The participants were primarily college students, and the messages were limited to single words expressing positive or negative feelings. The artificial nature of the experimental conditions raises questions about the generalizability of the findings to natural communication situations.</p>
    
    <h4>Paragraph D</h4>
    <p>Despite the limitations of Mehrabian's research, his findings have had a significant impact on popular understanding of communication. Many self-help books, business training programs, and communication courses have cited his work as evidence that body language is the key to effective communication. This has led to an overemphasis on non-verbal communication in some contexts. For example, job candidates are often advised to focus more on their body language than on the content of their answers during interviews. Similarly, salespeople are encouraged to pay more attention to their gestures and facial expressions than to the features of the products they are selling.</p>
    
    <h4>Paragraph E</h4>
    <p>Subsequent research has provided a more nuanced understanding of the relationship between verbal and non-verbal communication. Studies have shown that the relative importance of verbal and non-verbal messages depends on the context, the relationship between communicators, and the nature of the message being conveyed. In some situations, such as technical discussions or negotiations, the content of the message may be more important than non-verbal cues. In other situations, such as expressing emotions or building rapport, non-verbal communication may play a larger role. Cultural differences also affect how verbal and non-verbal messages are interpreted.</p>
    
    <h4>Paragraph F</h4>
    <p>Research has also shown that effective communication often involves the integration of verbal and non-verbal messages. When verbal and non-verbal messages are congruent, they reinforce each other and make the communication more persuasive and memorable. When they are incongruent, as in Mehrabian's studies, people may experience confusion or uncertainty about how to interpret the message. In such cases, they may rely more heavily on non-verbal cues because these are often perceived as more authentic indicators of a person's true feelings. However, this does not mean that non-verbal communication is inherently more important than verbal communication.</p>
    
    <h4>Paragraph G</h4>
    <p>Modern communication research recognizes that both verbal and non-verbal messages play important roles in human communication. Rather than trying to determine which is more important, researchers now focus on how these different channels work together to create meaning. This approach acknowledges that communication is a complex process that cannot be reduced to simple percentages. The effectiveness of communication depends on many factors, including the clarity of the message, the appropriateness of the communication channel, the skills of the communicators, and the receptiveness of the audience.</p>
    
    <h4>Paragraph H</h4>
    <p>The enduring popularity of Mehrabian's findings, despite their limitations, illustrates how scientific research can be oversimplified and misapplied in popular culture. This phenomenon is not unique to communication research; it occurs in many fields where complex findings are reduced to catchy sound bites. The responsibility lies not only with researchers to communicate their findings clearly, but also with the media and the public to understand the limitations of scientific studies. As consumers of information, we should be critical of oversimplified claims and seek to understand the context and limitations of research findings.</p>
    
  </section>
  <div id="divider" title="Drag to resize"></div>
  <section class="pane" id="right">
    <h3>Questions</h3>
    
    <div class="group">
      <h4>Questions 27‚Äì32</h4>
      <p>Reading Passage 3 has eight paragraphs, A‚ÄìH.</p>
      <p>Which paragraph contains the following information?</p>
      <p>Write the correct letter, A‚ÄìH, in boxes 27‚Äì32 on your answer sheet.</p>
      
      <div id="q27-anchor">
        <p><span class="q-item">27</span> &nbsp;&nbsp;&nbsp; A reference to the integration of verbal and non-verbal messages<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q27" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q27" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q27" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q27" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q27" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q27" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q27" value="G"> G &nbsp;&nbsp;&nbsp;
        <input type="radio" name="q27" value="H"> H</p>
      </div>
      
      <div id="q28-anchor">
        <p><span class="q-item">28</span> &nbsp;&nbsp;&nbsp; A reference to the misinterpretation of research findings<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q28" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q28" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q28" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q28" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q28" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q28" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q28" value="G"> G &nbsp;&nbsp;&nbsp;
        <input type="radio" name="q28" value="H"> H</p>
      </div>
      
      <div id="q29-anchor">
        <p><span class="q-item">29</span> &nbsp;&nbsp;&nbsp; A reference to the conditions under which the research was conducted<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q29" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q29" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q29" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q29" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q29" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q29" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q29" value="G"> G &nbsp;&nbsp;&nbsp;
        <input type="radio" name="q29" value="H"> H</p>
      </div>
      
      <div id="q30-anchor">
        <p><span class="q-item">30</span> &nbsp;&nbsp;&nbsp; A reference to the impact of research on popular understanding<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q30" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q30" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q30" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q30" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q30" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q30" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q30" value="G"> G &nbsp;&nbsp;&nbsp;
        <input type="radio" name="q30" value="H"> H</p>
      </div>
      
      <div id="q31-anchor">
        <p><span class="q-item">31</span> &nbsp;&nbsp;&nbsp; A reference to factors affecting the interpretation of messages<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q31" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q31" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q31" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q31" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q31" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q31" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q31" value="G"> G &nbsp;&nbsp;&nbsp;
        <input type="radio" name="q31" value="H"> H</p>
      </div>
      
      <div id="q32-anchor">
        <p><span class="q-item">32</span> &nbsp;&nbsp;&nbsp; A reference to how scientific research can be misapplied<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q32" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q32" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q32" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q32" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q32" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q32" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q32" value="G"> G &nbsp;&nbsp;&nbsp;
        <input type="radio" name="q32" value="H"> H</p>
      </div>
    </div>
    
    <div class="group">
      <h4>Questions 33‚Äì36</h4>
      <p>Complete each sentence with the correct ending, A‚ÄìH, below.</p>
      <p>Write the correct letter, A‚ÄìH, in boxes 33‚Äì36 on your answer sheet.</p>
      
      <div id="q33-anchor">
        <p><span class="q-item">33</span> &nbsp;&nbsp;&nbsp; Aristotle's communication theory suggested that a speaker needed to be credible, appealing, and logical<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="A"> A &nbsp;&nbsp;&nbsp; to be persuasive.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="B"> B &nbsp;&nbsp;&nbsp; regardless of the context.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="C"> C &nbsp;&nbsp;&nbsp; in all situations.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="D"> D &nbsp;&nbsp;&nbsp; to understand how communication works.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="E"> E &nbsp;&nbsp;&nbsp; only 7% of the time.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="F"> F &nbsp;&nbsp;&nbsp; in natural communication situations.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="G"> G &nbsp;&nbsp;&nbsp; to express positive or negative feelings.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="H"> H &nbsp;&nbsp;&nbsp; to determine which is more important.</p>
      </div>
      
      <div id="q34-anchor">
        <p><span class="q-item">34</span> &nbsp;&nbsp;&nbsp; Mehrabian's findings have led to the popular belief that we communicate more<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="A"> A &nbsp;&nbsp;&nbsp; to be persuasive.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="B"> B &nbsp;&nbsp;&nbsp; regardless of the context.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="C"> C &nbsp;&nbsp;&nbsp; in all situations.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="D"> D &nbsp;&nbsp;&nbsp; to understand how communication works.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="E"> E &nbsp;&nbsp;&nbsp; only 7% of the time.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="F"> F &nbsp;&nbsp;&nbsp; through body language than through words.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="G"> G &nbsp;&nbsp;&nbsp; to express positive or negative feelings.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="H"> H &nbsp;&nbsp;&nbsp; to determine which is more important.</p>
      </div>
      
      <div id="q35-anchor">
        <p><span class="q-item">35</span> &nbsp;&nbsp;&nbsp; The artificial nature of the experimental conditions<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="A"> A &nbsp;&nbsp;&nbsp; to be persuasive.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="B"> B &nbsp;&nbsp;&nbsp; raises questions about the generalizability of the findings.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="C"> C &nbsp;&nbsp;&nbsp; in all situations.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="D"> D &nbsp;&nbsp;&nbsp; to understand how communication works.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="E"> E &nbsp;&nbsp;&nbsp; only 7% of the time.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="F"> F &nbsp;&nbsp;&nbsp; through body language than through words.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="G"> G &nbsp;&nbsp;&nbsp; to express positive or negative feelings.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="H"> H &nbsp;&nbsp;&nbsp; to determine which is more important.</p>
      </div>
      
      <div id="q36-anchor">
        <p><span class="q-item">36</span> &nbsp;&nbsp;&nbsp; Modern communication research recognizes that both verbal and non-verbal messages<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="A"> A &nbsp;&nbsp;&nbsp; to be persuasive.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="B"> B &nbsp;&nbsp;&nbsp; regardless of the context.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="C"> C &nbsp;&nbsp;&nbsp; play important roles in human communication.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="D"> D &nbsp;&nbsp;&nbsp; to understand how communication works.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="E"> E &nbsp;&nbsp;&nbsp; only 7% of the time.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="F"> F &nbsp;&nbsp;&nbsp; through body language than through words.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="G"> G &nbsp;&nbsp;&nbsp; to express positive or negative feelings.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="H"> H &nbsp;&nbsp;&nbsp; to determine which is more important.</p>
      </div>
    </div>
    
    <div class="group">
      <h4>Questions 37‚Äì40</h4>
      <p>Do the following statements agree with the information given in Reading Passage 3?</p>
      <p>In boxes 37‚Äì40 on your answer sheet, write</p>
      <p><strong>TRUE</strong> &nbsp;&nbsp;&nbsp; if the statement agrees with the information<br>
      <strong>FALSE</strong> &nbsp;&nbsp;&nbsp; if the statement contradicts the information<br>
      <strong>NOT GIVEN</strong> &nbsp;&nbsp;&nbsp; if there is no information on this</p>
      
      <div id="q37-anchor">
        <p><span class="q-item">37</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q37" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q37" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q37" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mehrabian's study suggested that non-verbal messages are always more important than verbal messages.</p>
      </div>
      
      <div id="q38-anchor">
        <p><span class="q-item">38</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q38" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q38" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q38" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mehrabian's research participants were a diverse group of people.</p>
      </div>
      
      <div id="q39-anchor">
        <p><span class="q-item">39</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q39" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q39" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q39" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Effective communication often involves the integration of verbal and non-verbal messages.</p>
      </div>
      
      <div id="q40-anchor">
        <p><span class="q-item">40</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q40" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q40" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q40" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The responsibility for understanding research findings lies only with the researchers.</p>
      </div>
    </div>
    
    <div style="display:flex;gap:8px;margin-bottom:10px;">
      <button class="primary" onclick="grade()">Submit</button>
      <button onclick="resetForm()">Reset</button>
      <button onclick="toggleNotes()">Notes</button>
    </div>
    <div id="results"></div>
    <details class="answerbox" id="answerBox">
      <summary>Show answers (click to toggle) <span class="badge">hidden</span></summary>
      <div id="answerContent"></div>
    </details>
  </section>
</div>

<div aria-label="Selection tools" id="selbar" role="toolbar">
  <button id="btnHL">Highlight</button>
  <button id="btnUH">Remove</button>
  <button id="btnNote">Note</button>
</div>

<div id="notes">
  <header>
    <strong>Notes</strong>
    <div>
      <button id="btnCopy">Copy</button>
      <button id="btnClose">Close</button>
    </div>
  </header>
  <textarea id="noteArea" placeholder="Type your notes here..."></textarea>
</div>

<div id="toast"></div>

<script>
// È°µÈù¢ÊªöÂä®ÂäüËÉΩ
function scrollToElement(id) {
  const element = document.getElementById(id);
  if (element) {
    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
    // È´ò‰∫ÆÊòæÁ§∫È¢òÁõÆ
    element.style.backgroundColor = '#e0e7ff';
    setTimeout(() => {
      element.style.backgroundColor = '';
    }, 1000);
  }
}

// ÈáçÁΩÆË°®ÂçïÂäüËÉΩ
function resetForm() {
  // ÈáçÁΩÆÂçïÈÄâÊåâÈíÆ
  document.querySelectorAll('input[type="radio"]').forEach(radio => {
    radio.checked = false;
  });
  
  // ÈáçÁΩÆÊñáÊú¨ËæìÂÖ•Ê°Ü
  document.querySelectorAll('input.blank').forEach(input => {
    input.value = '';
  });
  
  // Ê∏ÖÈô§ÁªìÊûú
  document.getElementById('results').innerHTML = '';
  
  // Êõ¥Êñ∞ÂØºËà™Áä∂ÊÄÅ
  updateAnswerStatus();
  
  showToast('Form reset');
}

// ToastÈÄöÁü•ÂäüËÉΩ
function showToast(msg) {
  const toastEl = document.getElementById('toast');
  toastEl.textContent = msg;
  toastEl.style.display = 'block';
  setTimeout(() => {
    toastEl.style.display = 'none';
  }, 1500);
}

// ËÆ°Êó∂Âô®ÂäüËÉΩ
let _t = 0;
let timerRunning = true;
let timerInterval;
const _timerEl = document.getElementById('timer');

function updateTimer() {
  const m = Math.floor(_t / 60);
  const s = _t % 60;
  _timerEl.textContent = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
}

function startTimer() {
  timerInterval = setInterval(() => {
    if (timerRunning) {
      _t++;
      updateTimer();
    }
  }, 1000);
}

function toggleTimer() {
  if (timerRunning) {
    clearInterval(timerInterval);
    timerRunning = false;
    _timerEl.classList.add('paused');
    showToast('Timer paused');
  } else {
    startTimer();
    timerRunning = true;
    _timerEl.classList.remove('paused');
    showToast('Timer resumed');
  }
}

// ‰∏ªÈ¢òÂàáÊç¢ÂäüËÉΩ
function toggleTheme() {
  document.body.classList.toggle('dark');
  const isDark = document.body.classList.contains('dark');
  localStorage.setItem('darkMode', isDark);
  const themeButton = document.querySelector('.theme-toggle');
  themeButton.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
}

// ÊãñÊãΩÂàÜÊ†èÂäüËÉΩ
var divider = document.getElementById('divider');
var left = document.getElementById('left');
var right = document.getElementById('right');
var dragging = false;

function startDrag(e) {
  dragging = true;
  document.body.style.cursor = 'ew-resize';
  if (e.preventDefault) e.preventDefault();
}

function endDrag() {
  dragging = false;
  document.body.style.cursor = '';
}

function onMove(clientX) {
  var container = document.querySelector('.shell').getBoundingClientRect();
  var x = clientX - container.left;
  x = Math.max(280, Math.min(container.width - 320, x));
  left.style.flex = '0 0 ' + x + 'px';
  right.style.flex = '1 1 auto';
}

divider.addEventListener('mousedown', function(e) { startDrag(e); });
window.addEventListener('mousemove', function(e) { if (dragging) onMove(e.clientX); });
window.addEventListener('mouseup', endDrag);
divider.addEventListener('touchstart', function(e) { startDrag(e.touches[0]); }, { passive: false });
window.addEventListener('touchmove', function(e) { if (dragging) onMove(e.touches[0].clientX); }, { passive: false });
window.addEventListener('touchend', endDrag);

// È´ò‰∫ÆÂíåÁ¨îËÆ∞ÂäüËÉΩ
var selbar = document.getElementById('selbar');
var btnHL = document.getElementById('btnHL');
var btnUH = document.getElementById('btnUH');
var btnNote = document.getElementById('btnNote');
var lastRange = null;
var currentHlNode = null;
var keepToolbar = false;

function positionSelbarForRect(rect) {
  selbar.style.display = 'flex';
  requestAnimationFrame(function() {
    var top = window.scrollY + rect.top - selbar.offsetHeight - 8;
    var leftPos = window.scrollX + rect.left + rect.width/2 - selbar.offsetWidth/2;
    selbar.style.top = ((top > 0) ? top : (window.scrollY + rect.bottom + 8)) + 'px';
    selbar.style.left = Math.max(8, leftPos) + 'px';
  });
}

function updateSelbar() {
  var sel = window.getSelection();
  if (!sel || sel.rangeCount === 0 || sel.isCollapsed) {
    selbar.style.display = 'none';
    currentHlNode = null;
    return;
  }
  var range = sel.getRangeAt(0);
  lastRange = range.cloneRange();
  currentHlNode = null;
  positionSelbarForRect(range.getBoundingClientRect());
}

document.getElementById('left').addEventListener('mouseup', updateSelbar);
document.getElementById('right').addEventListener('mouseup', updateSelbar);
document.addEventListener('selectionchange', function() {
  var sel = window.getSelection();
  if (!sel || sel.rangeCount === 0 || sel.isCollapsed) {
    if (!keepToolbar && !currentHlNode) {
      selbar.style.display = 'none';
    }
  }
});
document.addEventListener('scroll', function() {
  if (selbar.style.display === 'flex') updateSelbar();
});

document.addEventListener('mousedown', function(e) {
  var t = e.target;
  if (t.classList && t.classList.contains('hl')) {
    keepToolbar = true;
  } else {
    keepToolbar = false;
  }
}, true);

document.addEventListener('click', function(e) {
  var target = e.target;
  if (target.classList && target.classList.contains('hl')) {
    currentHlNode = target;
    lastRange = null;
    positionSelbarForRect(target.getBoundingClientRect());
    var sel = window.getSelection();
    if (sel) sel.removeAllRanges();
    setTimeout(function() { keepToolbar = false; }, 0);
  }
}, true);

function doHighlight() {
  if (currentHlNode) return;
  if (!lastRange || lastRange.collapsed) return;
  
  const startNode = lastRange.startContainer;
  const endNode = lastRange.endContainer;
  
  if (startNode === endNode) {
    try {
      const span = document.createElement('span');
      span.className = 'hl';
      lastRange.surroundContents(span);
      selbar.style.display = 'none';
      showToast('Highlighted');
      return;
    } catch (e) {}
  }
  
  const fragment = lastRange.cloneContents();
  const div = document.createElement('div');
  div.appendChild(fragment);
  
  function processNode(node) {
    if (node.nodeType === Node.TEXT_NODE) {
      if (node.textContent.trim().length > 0) {
        const span = document.createElement('span');
        span.className = 'hl';
        span.textContent = node.textContent;
        return span;
      }
      return node;
    }
    
    if (node.nodeType === Node.ELEMENT_NODE) {
      const isBlock = window.getComputedStyle(node).display.includes('block') ||
        ['P', 'H1', 'H2', 'H3', 'H4', 'DIV'].includes(node.tagName);
      
      const wrapper = isBlock ? document.createElement(node.tagName.toLowerCase()) : document.createElement('span');
      wrapper.className = isBlock ? node.className + ' hl' : 'hl';
      
      Array.from(node.attributes).forEach(attr => {
        wrapper.setAttribute(attr.name, attr.value);
      });
      
      while (node.firstChild) {
        const processedChild = processNode(node.firstChild);
        wrapper.appendChild(processedChild);
      }
      
      return wrapper;
    }
    
    return node;
  }
  
  const highlightedContent = processNode(div);
  lastRange.deleteContents();
  lastRange.insertNode(highlightedContent);
  
  selbar.style.display = 'none';
  showToast('Highlighted');
}

function removeHighlight() {
  if (currentHlNode) {
    const parent = currentHlNode.parentNode;
    while (currentHlNode.firstChild) {
      parent.insertBefore(currentHlNode.firstChild, currentHlNode);
    }
    parent.removeChild(currentHlNode);
    parent.normalize();
    currentHlNode = null;
    selbar.style.display = 'none';
    showToast('Highlight removed');
    return;
  }
  
  if (!lastRange) return;
  
  const selRect = lastRange.getBoundingClientRect();
  const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_ELEMENT);
  const toRemove = [];
  
  while (walker.nextNode()) {
    const node = walker.currentNode;
    if (node.classList && node.classList.contains('hl')) {
      const rect = node.getBoundingClientRect();
      if (!(rect.right < selRect.left || rect.left > selRect.right ||
        rect.bottom < selRect.top || rect.top > selRect.bottom)) {
        toRemove.push(node);
      }
    }
  }
  
  toRemove.forEach(el => {
    const parent = el.parentNode;
    while (el.firstChild) {
      parent.insertBefore(el.firstChild, el);
    }
    parent.removeChild(el);
    parent.normalize();
  });
  
  selbar.style.display = 'none';
  showToast('Highlight removed');
}

btnHL.addEventListener('click', doHighlight);
btnUH.addEventListener('click', removeHighlight);

// Á¨îËÆ∞ÂäüËÉΩ
var notes = document.getElementById('notes');
var noteArea = document.getElementById('noteArea');
var btnCopy = document.getElementById('btnCopy');
var btnClose = document.getElementById('btnClose');

function toggleNotes() {
  notes.style.display = (notes.style.display === 'flex' ? 'none' : 'flex');
}
window.toggleNotes = toggleNotes;

btnClose.addEventListener('click', toggleNotes);
btnCopy.addEventListener('click', async function() {
  await navigator.clipboard.writeText(noteArea.value || '');
  showToast('Copied');
});

btnNote.addEventListener('click', function() {
  var text = '';
  if (currentHlNode) {
    text = (currentHlNode.textContent || '').trim();
  } else if (lastRange) {
    var frag = lastRange.cloneContents();
    text = (frag.textContent || '').trim();
  }
  toggleNotes();
  if (text) {
    noteArea.value = (noteArea.value ? noteArea.value + '\n' : '') + '> ' + text + '\n';
  }
  selbar.style.display = 'none';
});

// Á≠îÈ¢òÁä∂ÊÄÅÊõ¥Êñ∞
function updateAnswerStatus() {
  for (let i = 27; i <= 40; i++) {
    const inputs = document.querySelectorAll(`input[name="q${i}"]`);
    const navItem = document.getElementById(`q${i}-nav`);
    if (navItem) {
      let answered = false;
      inputs.forEach(input => {
        if ((input.type === 'radio' || input.type === 'checkbox') && input.checked) {
          answered = true;
        } else if (input.type === 'text' && input.value.trim()) {
          answered = true;
        }
      });
      if (answered) {
        navItem.classList.add('answered');
      } else {
        navItem.classList.remove('answered');
      }
    }
  }
}

// Á≠îÊ°àÂíåËØÑÂàÜÁ≥ªÁªü
var answers = {
  "q27": "F", "q28": "B", "q29": "C", "q30": "D", "q31": "E", "q32": "H",
  "q33": "A", "q34": "F", "q35": "B", "q36": "C",
  "q37": "FALSE", "q38": "FALSE", "q39": "TRUE", "q40": "FALSE"
};

function grade() {
  var total = 0, correct = 0, lines = [];
  
  // Ê£ÄÊü•ÂçïÈÄâÈ¢ò (27-40)
  for (let n = 27; n <= 40; n++) {
    const q = `q${n}`;
    total++;
    const selected = document.querySelector(`input[name="${q}"]:checked`);
    const userAnswer = selected ? selected.value : '';
    const isCorrect = userAnswer === answers[q];
    if (isCorrect) correct++;
    lines.push(`${q.toUpperCase()}: ${userAnswer || 'None'} ${isCorrect ? '‚úì' : '‚úó'}`);
  }
  
  // ÊòæÁ§∫ÁªìÊûú
  const acc = Math.round(100 * correct / total);
  document.getElementById('results').innerHTML = `
    <p><strong>Score:</strong> ${correct}/${total} <span class="badge">Accuracy ${acc}%</span></p>
    <pre>${lines.join('\n')}</pre>
  `;
  
  // ÊòæÁ§∫Á≠îÊ°à
  document.getElementById('answerContent').innerHTML = `
    <ol>
      <li>27 ‚Üí F</li>
      <li>28 ‚Üí B</li>
      <li>29 ‚Üí C</li>
      <li>30 ‚Üí D</li>
      <li>31 ‚Üí E</li>
      <li>32 ‚Üí H</li>
      <li>33 ‚Üí A</li>
      <li>34 ‚Üí F</li>
      <li>35 ‚Üí B</li>
      <li>36 ‚Üí C</li>
      <li>37 ‚Üí FALSE</li>
      <li>38 ‚Üí FALSE</li>
      <li>39 ‚Üí TRUE</li>
      <li>40 ‚Üí FALSE</li>
    </ol>
  `;
  document.querySelector('#answerBox .badge').textContent = 'tap to view';
  
  updateAnswerStatus();
}

// ÁõëÂê¨Á≠îÊ°àÂèòÂåñ
document.addEventListener('change', updateAnswerStatus);
document.addEventListener('input', updateAnswerStatus);

// È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
document.addEventListener('DOMContentLoaded', function() {
  startTimer();
  updateAnswerStatus(); // ÂàùÂßãÂåñÁ≠îÈ¢òÁä∂ÊÄÅ
  
  // Âä†ËΩΩ‰øùÂ≠òÁöÑ‰∏ªÈ¢ò
  if (localStorage.getItem('darkMode') === 'true') {
    document.body.classList.add('dark');
    document.querySelector('.theme-toggle').textContent = '‚òÄÔ∏è';
  }
});

// ÁªÉ‰π†È°µÈù¢Â¢ûÂº∫ËÑöÊú¨ÈõÜÊàê
function loadPracticePageEnhancer() {
  const script = document.createElement('script');
  script.src = '../../../js/practice-page-enhancer.js';
  script.onload = function() {
    console.log('ÁªÉ‰π†È°µÈù¢Â¢ûÂº∫ËÑöÊú¨Â∑≤Âä†ËΩΩ');
  };
  script.onerror = function() {
    console.error('ÁªÉ‰π†È°µÈù¢Â¢ûÂº∫ËÑöÊú¨Âä†ËΩΩÂ§±Ë¥•');
    // ÈôçÁ∫ßÂà∞ÂÜÖËÅîÂ¢ûÂº∫
    loadInlineEnhancer();
  };
  document.head.appendChild(script);
}

// ÂÜÖËÅîÂ¢ûÂº∫Âô®ÔºàÈôçÁ∫ßÊñπÊ°àÔºâ
function loadInlineEnhancer() {
  if (window.practicePageEnhancer) return;
  
  window.practicePageEnhancer = {
    initialize: function() {
      console.log('[InlineEnhancer] ÂÜÖËÅîÂ¢ûÂº∫Âô®Â∑≤ÂàùÂßãÂåñ');
      this.setupCommunication();
      this.setupAnswerListeners();
      this.interceptSubmit();
    },
    
    setupCommunication: function() {
      this.parentWindow = window.opener || window.parent;
      window.addEventListener('message', (event) => {
        if (event.data && event.data.type === 'INIT_SESSION') {
          this.sessionId = event.data.data.sessionId;
          this.sendMessage('SESSION_READY', {
            pageType: this.detectPageType(),
            url: window.location.href
          });
        }
      });
    },
    
    detectPageType: function() {
      const title = document.title || '';
      if (title.includes('P1')) return 'P1';
      if (title.includes('P2')) return 'P2';
      if (title.includes('P3')) return 'P3';
      return 'unknown';
    },
    
    setupAnswerListeners: function() {
      this.answers = {};
      this.startTime = Date.now();
      
      document.addEventListener('change', (e) => {
        if (e.target.name && e.target.name.startsWith('q')) {
          this.answers[e.target.name] = e.target.value;
        }
      });
      
      document.addEventListener('input', (e) => {
        if (e.target.name && e.target.name.startsWith('q')) {
          this.answers[e.target.name] = e.target.value;
        }
      });
    },
    
    interceptSubmit: function() {
      // Êã¶Êà™gradeÂáΩÊï∞
      if (typeof window.grade === 'function') {
        const originalGrade = window.grade;
        window.grade = () => {
          const result = originalGrade();
          setTimeout(() => this.handleSubmit(), 200);
          return result;
        };
      }
      
      // ÁõëÂê¨Êèê‰∫§ÊåâÈíÆ
      document.addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON' &&
          (e.target.textContent.includes('Submit') ||
            e.target.onclick && e.target.onclick.toString().includes('grade'))) {
          setTimeout(() => this.handleSubmit(), 300);
        }
      });
    },
    
    handleSubmit: function() {
      const results = {
        sessionId: this.sessionId,
        startTime: this.startTime,
        endTime: Date.now(),
        duration: Math.round((Date.now() - this.startTime) / 1000),
        answers: this.answers,
        scoreInfo: this.extractScore(),
        pageType: this.detectPageType(),
        url: window.location.href
      };
      
      this.sendMessage('PRACTICE_COMPLETE', results);
    },
    
    extractScore: function() {
      const resultsEl = document.getElementById('results');
      if (!resultsEl) return null;
      
      const text = resultsEl.textContent || '';
      const scoreMatch = text.match(/Score:\s*(\d+)\/(\d+)/i);
      if (scoreMatch) {
        const correct = parseInt(scoreMatch[1]);
        const total = parseInt(scoreMatch[2]);
        return {
          correct: correct,
          total: total,
          accuracy: total > 0 ? correct / total : 0,
          percentage: Math.round((correct / total) * 100),
          source: 'inline_extraction'
        };
      }
      return null;
    },
    
    sendMessage: function(type, data) {
      if (this.parentWindow) {
        this.parentWindow.postMessage({
          type: type,
          data: data,
          source: 'practice_page'
        }, '*');
      }
    }
  };
  
  // ÂàùÂßãÂåñ
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      window.practicePageEnhancer.initialize();
    });
  } else {
    window.practicePageEnhancer.initialize();
  }
}

// Âä†ËΩΩÂ¢ûÂº∫ËÑöÊú¨
loadPracticePageEnhancer();
</script>

</body>
</html>