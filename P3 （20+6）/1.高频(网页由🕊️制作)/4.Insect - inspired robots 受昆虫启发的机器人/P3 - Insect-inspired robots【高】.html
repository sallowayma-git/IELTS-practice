<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Insect-inspired robots - Reading Passage 3</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  :root { 
    --line:#e5e7eb; 
    --bg:#f6f7fb; 
    --panel:#fff; 
    --accent:#3b82f6; 
    --muted:#6b7280; 
    --shadow:0 6px 20px rgba(0,0,0,.12); 
  }
  * { box-sizing: border-box; }
  html,body { height:100%; }
  body { 
    margin:0; 
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; 
    background:var(--bg); 
    padding-bottom: 82px; 
  }
  
  /* Â∏ÉÂ±ÄÊ†∑Âºè */
  .shell { display:flex; height:100vh; width:100%; }
  .pane { background:var(--panel); overflow:auto; padding:20px; }
  #left { flex: 0 0 50%; min-width: 280px; }
  #right { flex: 1 1 auto; min-width: 320px; background:#fbfbff; border-left:1px solid var(--line); }
  #divider { flex: 0 0 8px; background: linear-gradient(90deg,#e5e7eb,#d1d5db); cursor: ew-resize; position:relative; z-index: 5; user-select:none; }
  
  /* ÊñáÊú¨Ê†∑Âºè */
  h2,h3,h4 { margin:0 0 10px; }
  #left p { margin: 0 0 12px; line-height: 1.6; word-break: normal; overflow-wrap: normal; hyphens: none; }
  
  /* ÁªÑ‰ª∂Ê†∑Âºè */
  .group { background:#fff; border:1px solid var(--line); border-radius:10px; padding:12px; margin-bottom:14px; }
  input.blank { 
    border:none; 
    border-bottom:1px solid #9ca3af; 
    padding:2px 4px; 
    font-size:1em; 
    background:transparent; 
    min-width: 80px;
  }
  input.blank:focus { outline:none; border-bottom:2px solid var(--accent); }
  
  /* ÊåâÈíÆÊ†∑Âºè */
  button { 
    padding:8px 12px; 
    border:1px solid var(--line); 
    background:#fff; 
    border-radius:6px; 
    cursor:pointer; 
    transition:all 0.2s; 
    font-size:14px; 
  }
  button:hover { background:#f8fafc; border-color:#cbd5e1; }
  button.primary { 
    background:var(--accent); 
    color:#fff; 
    border-color:var(--accent); 
  }
  button.primary:hover { background:#2563eb; }
  
  /* ËÆ°Êó∂Âô®Ê†∑Âºè */
  #timer { 
    background:#fff; 
    color:var(--muted); 
    border:1px solid var(--line); 
    border-radius:6px; 
    padding:6px 12px; 
    cursor:pointer; 
    font-family: 'Courier New', monospace; 
    transition:all 0.2s; 
    min-width: 70px;
    text-align: center;
    font-size: 18px;
    font-weight: bold;
  }
  #timer:hover { 
    background:#f1f5f9; 
    border-color:var(--accent); 
  }
  #timer.paused { 
    color: #ef4444; 
    border-color: #fecaca; 
    background: #fef2f2; 
  }
  
  /* ‰∏ªÈ¢òÂàáÊç¢ÊåâÈíÆ */
  .theme-toggle { 
    background:#fff; 
    color:var(--muted); 
    border:1px solid var(--line); 
    border-radius:6px; 
    width: 36px;
    height: 36px;
    font-size: 16px;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .theme-toggle:hover {
    background: var(--accent);
    color: #fff;
    border-color: var(--accent);
    transform: scale(1.05);
  }
  .theme-toggle:active {
    transform: scale(0.95);
  }
  
  /* ÊãñÊãΩÁõ∏ÂÖ≥Ê†∑Âºè */
  .dropzone { 
    border:2px dashed #cbd5e1; 
    background:#f8fafc; 
    border-radius:10px; 
    min-height:54px; 
    padding:8px; 
    display:flex; 
    align-items:center; 
    justify-content:space-between; 
    gap:8px; 
  }
  .droplabel { color:#64748b; }
  .cardpool { 
    background:#f1f5f9; 
    border-radius:10px; 
    padding:12px; 
    display:grid; 
    gap:8px; 
  }
  .pool-slot { min-height:40px; }
  .card { 
    background:#fff; 
    border:1px solid #e5e7eb; 
    border-radius:8px; 
    padding:8px 10px; 
    display:inline-flex; 
    gap:8px; 
    align-items:center; 
    cursor:grab; 
    box-shadow:0 1px 0 rgba(0,0,0,.03); 
  }
  .card:active { cursor:grabbing; }
  .tag { 
    background:#eef2ff; 
    color:#4338ca; 
    padding:2px 8px; 
    border-radius:999px; 
    font-size:12px; 
  }
  .btn-clear { 
    border:1px solid #e5e7eb; 
    background:#fff; 
    border-radius:8px; 
    padding:6px 8px; 
    cursor:pointer; 
  }
  .ghost { opacity: .5; }
  .over { outline:2px dashed #3b82f6; }
  
  /* Ê∑±Ëâ≤Ê®°ÂºèÊ†∑Âºè */
  body.dark { 
    --bg: #0f172a; 
    --panel: #1e293b; 
    --line: #334155; 
    --muted: #94a3b8; 
    color: #e2e8f0; 
  }
  body.dark #right { background: #0f172a; }
  body.dark .group { background: #1e293b; border-color: #334155; }
  body.dark button { background: #1e293b; color: #e2e8f0; border-color: #334155; }
  body.dark button:hover { background: #334155; }
  body.dark button.primary { background: var(--accent); color: #fff; }
  body.dark #results { background: #1e293b; border-color: #334155; }
  body.dark #notes { background: #1e293b; border-color: #334155; color: #e2e8f0; }
  body.dark .practice-nav { background: #1e293b; border-color: #334155; }
  body.dark .q-item { background: #0f172a; color: #e2e8f0; border-color: #334155; }
  body.dark .q-item:hover { background: #334155; }
  body.dark .q-item.answered { background: #1e40af; border-color: var(--accent); color: #93c5fd; }
  body.dark #timer { background: #1e293b; color: #e2e8f0; border-color: #334155; }
  body.dark #timer:hover { background: #334155; border-color: var(--accent); }
  body.dark details.answerbox { background: #1e293b; border-color: #334155; }
  body.dark input.blank { color: #e2e8f0; border-bottom-color: #64748b; }
  body.dark input.blank:focus { border-bottom-color: var(--accent); }
  body.dark .cardpool { background:#1e293b; }
  body.dark .card { background:#334155; border-color: #475569; }
  body.dark .dropzone { background:#1e293b; border-color: #475569; }
  body.dark .tag { background:#334155; color:#93c5fd; }
  body.dark .btn-clear { background:#334155; border-color: #475569; }
  
  /* ÂìçÂ∫îÂºèËÆæËÆ° */
  @media (max-width: 768px) {
    .shell { flex-direction: column; }
    #left, #right { flex: none; min-width: auto; }
    #divider { display: none; }
    .practice-nav .controls { gap: 8px; }
    #timer { font-size: 12px; padding: 3px 8px; }
    .theme-toggle { width: 32px; height: 32px; font-size: 14px; }
    #notes { width: calc(100vw - 24px); right: 12px; left: 12px; }
  }
  
  /* ÈÄâÊã©Â∑•ÂÖ∑Ê†è */
  #selbar { 
    position: fixed; 
    display:none; 
    z-index: 2000; 
    background:#111; 
    color:#fff; 
    border-radius: 8px; 
    padding: 6px; 
    box-shadow: var(--shadow); 
    font-size: 13px; 
    gap:6px; 
    align-items: center; 
  }
  #selbar button { 
    background: transparent; 
    color:#fff; 
    border: 1px solid rgba(255,255,255,.25); 
    padding: 4px 8px; 
    border-radius: 6px; 
    cursor:pointer; 
  }
  #selbar button:hover { border-color:#fff; }
  
  /* Á¨îËÆ∞Èù¢Êùø */
  #notes { 
    position: fixed; 
    right: 12px; 
    bottom: 12px; 
    width: 320px; 
    height: 42vh; 
    background:#fff; 
    border:1px solid var(--line); 
    border-radius: 12px; 
    display:none; 
    flex-direction: column; 
    z-index:1500; 
    box-shadow: var(--shadow); 
  }
  #notes header { 
    display:flex; 
    align-items:center; 
    justify-content: space-between; 
    padding:8px 10px; 
    border-bottom:1px solid var(--line); 
  }
  #notes textarea { 
    flex:1; 
    border:0; 
    padding:10px; 
    resize:none; 
    font-size:14px; 
    line-height:1.5; 
  }
  
  /* ToastÈÄöÁü• */
  #toast { 
    position: fixed; 
    bottom: 20px; 
    left: 50%; 
    transform: translateX(-50%); 
    background: rgba(0,0,0,0.8); 
    color: #fff; 
    padding: 8px 16px; 
    border-radius: 4px; 
    display: none; 
    z-index: 3000; 
    font-size: 14px; 
  }
  
  /* Á≠îÈ¢òÂØºËà™ */
  .practice-nav { 
    background:#fff; 
    padding:12px 20px; 
    display:flex; 
    align-items:center; 
    gap:16px; 
    box-shadow:0 2px 4px rgba(0,0,0,.05); 
    flex-wrap:wrap; 
    position:fixed; 
    left:0; 
    right:0; 
    bottom:0; 
    border-top:2px solid var(--line); 
    z-index:4000; 
  }
  .practice-nav .title { font-weight:600; color:var(--muted); }
  .practice-nav .questions { 
    display:flex; 
    gap:8px; 
    align-items:center; 
    flex-wrap:wrap; 
  }
  .practice-nav .q-item { 
    padding:6px 10px; 
    border:1px solid var(--line); 
    border-radius:6px; 
    background:#fff; 
    cursor:pointer; 
    font-size:14px; 
    transition:all 0.2s; 
    min-width:36px; 
    text-align:center; 
  }
  .practice-nav .q-item:hover { 
    background:#f1f5f9; 
    border-color:var(--accent); 
  }
  .practice-nav .q-item.answered { 
    background:#e0e7ff; 
    border-color:var(--accent); 
    color:var(--accent); 
    font-weight:500; 
  }
  .practice-nav .q-item.active { 
    background:var(--accent); 
    color:#fff; 
  }
  .practice-nav .controls { 
    display:flex; 
    gap:12px; 
    margin-left:auto; 
    align-items:center; 
  }
  
  /* Á≠îÈ¢òÁªìÊûúÊòæÁ§∫ */
  #results { 
    background:#fff; 
    border:1px solid var(--line); 
    border-radius:10px; 
    padding:12px; 
    margin:16px 0; 
    font-family: monospace; 
    white-space:pre-wrap; 
  }
  #results p { margin:0 0 8px; }
  .badge { 
    background:#e0e7ff; 
    color:var(--accent); 
    padding:2px 8px; 
    border-radius:999px; 
    font-size:12px; 
  }
  
  /* Á≠îÊ°àÊ°Ü */
  details.answerbox { 
    background:#fff; 
    border:1px solid var(--line); 
    border-radius:10px; 
    padding:12px; 
    margin-top:10px; 
  }
  details.answerbox summary { 
    cursor:pointer; 
    font-weight:600; 
    list-style:none; 
    display:flex; 
    align-items:center; 
    justify-content:space-between; 
  }
  details.answerbox summary::-webkit-details-marker { display:none; }
  #answerContent { margin-top:10px; }
  #answerContent ol { margin:0; padding-left:20px; }
  #answerContent li { margin:4px 0; }
  
  /* È´ò‰∫ÆÊ†∑Âºè */
  .hl { background: #ffeb3b; color: #000; }
  body.dark .hl { background: #8a6d00; color: #fff; }
  
  /* ÊªöÂä®Êù°Ê†∑Âºè */
  ::-webkit-scrollbar { width: 8px; height: 8px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: #c5c5d2; border-radius: 4px; }
  ::-webkit-scrollbar-thumb:hover { background: #999; }
  body.dark ::-webkit-scrollbar-thumb { background: #4a5568; }
  body.dark ::-webkit-scrollbar-thumb:hover { background: #718096; }
  
  table { border-collapse: collapse; width:100%; }
  th, td { border:1px solid var(--line); padding:6px; text-align:center; font-size:14px; }
  th:first-child, td:first-child { width:92px; }
</style>
</head>
<body>

<div class="practice-nav">
  <div class="title">Questions</div>
  <div class="questions">
    <div class="q-item" id="q27-nav" onclick="scrollToElement('q27-anchor')">27</div>
    <div class="q-item" id="q28-nav" onclick="scrollToElement('q28-anchor')">28</div>
    <div class="q-item" id="q29-nav" onclick="scrollToElement('q29-anchor')">29</div>
    <div class="q-item" id="q30-nav" onclick="scrollToElement('q30-anchor')">30</div>
    <div class="q-item" id="q31-nav" onclick="scrollToElement('q31-anchor')">31</div>
    <div class="q-item" id="q32-nav" onclick="scrollToElement('q32-anchor')">32</div>
    <div class="q-item" id="q33-nav" onclick="scrollToElement('q33-anchor')">33</div>
    <div class="q-item" id="q34-nav" onclick="scrollToElement('q34-anchor')">34</div>
    <div class="q-item" id="q35-nav" onclick="scrollToElement('q35-anchor')">35</div>
    <div class="q-item" id="q36-nav" onclick="scrollToElement('q36-anchor')">36</div>
    <div class="q-item" id="q37-nav" onclick="scrollToElement('q37-anchor')">37</div>
    <div class="q-item" id="q38-nav" onclick="scrollToElement('q38-anchor')">38</div>
    <div class="q-item" id="q39-nav" onclick="scrollToElement('q39-anchor')">39</div>
    <div class="q-item" id="q40-nav" onclick="scrollToElement('q40-anchor')">40</div>
  </div>
  <div class="controls">
    <span id="timer" onclick="toggleTimer()">00:00</span>
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark mode">üåô</button>
  </div>
</div>

<div class="shell">
  <section class="pane" id="left">
    <h2>READING PASSAGE 3</h2>
    <p>You should spend about 20 minutes on Questions 27‚Äì40, which are based on Reading Passage 3 below.</p>
    <h3>Insect-inspired robots</h3>
    
    <h4>Paragraph A</h4>
    <p>For centuries, humans have been fascinated by the remarkable abilities of insects. These small creatures can navigate complex environments, carry loads many times their own body weight, and adapt to changing conditions with incredible agility. Today, engineers and roboticists are turning to insects for inspiration in designing the next generation of robots. By studying the biomechanics and behaviors of insects, researchers hope to create robots that are more versatile, efficient, and resilient than current models. This approach, known as biomimicry, involves copying nature's designs and processes to solve human problems. Insect-inspired robots represent one of the most promising areas of biomimetic engineering, with potential applications ranging from search and rescue operations to space exploration.</p>
    
    <h4>Paragraph B</h4>
    <p>One of the most significant advantages of insect-inspired robots is their ability to navigate challenging terrains. Traditional wheeled robots often struggle in environments with obstacles, uneven surfaces, or confined spaces. In contrast, many insects can traverse such terrains with ease, thanks to their multiple legs and low center of gravity. Researchers have developed hexapod robots that mimic the walking patterns of insects like cockroaches and ants. These robots can walk over rough terrain, climb walls, and even right themselves when flipped over. The key to their success lies in their decentralized control systems, which allow each leg to respond independently to changes in the environment without requiring constant input from a central processor.</p>
    
    <h4>Paragraph C</h4>
    <p>Another area where insects excel is in their sensory capabilities. Many insects have sophisticated sensory systems that allow them to detect chemical signals, perceive polarized light, and sense vibrations in their environment. These abilities have inspired the development of robots with enhanced sensory capabilities. For example, researchers have created robots equipped with chemical sensors that mimic the olfactory systems of moths and other insects. These robots can detect trace amounts of chemicals in the air, making them useful for locating sources of pollution or detecting explosives. Similarly, scientists have developed robots with compound eyes that replicate the visual systems of flies, providing a wide field of view and the ability to detect fast-moving objects.</p>
    
    <h4>Paragraph D</h4>
    <p>Swarm intelligence is another insect behavior that has captured the attention of roboticists. Many social insects, such as ants and bees, work together in large groups to accomplish complex tasks that would be impossible for individuals to complete alone. This collective behavior, known as swarm intelligence, has inspired the development of robot swarms that can work together to perform tasks such as mapping unknown environments or constructing structures. Each robot in a swarm operates with simple rules and limited communication with other robots, yet the collective behavior of the group can be remarkably sophisticated. This approach offers several advantages, including robustness (if one robot fails, the others can continue) and scalability (the performance of the system can improve with the addition of more robots).</p>
    
    <h4>Paragraph E</h4>
    <p>Flight is perhaps the most impressive ability of many insects, and it has inspired numerous innovations in robotics. Insect flight is characterized by rapid wing movements, precise control, and exceptional maneuverability. Engineers have developed flapping-wing robots that mimic the flight patterns of insects like hummingbirds and fruit flies. These robots can hover in place, fly in any direction, and navigate through tight spaces. However, replicating insect flight has proven to be extremely challenging due to the complex aerodynamics involved. Insect wings generate lift and thrust through a combination of flapping, rotation, and deformation that is difficult to replicate with current technology. Despite these challenges, researchers continue to make progress in developing more sophisticated flying robots.</p>
    
    <h4>Paragraph F</h4>
    <p>Energy efficiency is another area where insects outperform most robots. Many insects can travel long distances relative to their body size while consuming minimal energy. This efficiency is achieved through a combination of factors, including lightweight bodies, efficient muscle systems, and optimized movement patterns. Researchers are studying these principles to develop robots that can operate for longer periods on a single battery charge. For example, some robots have been designed with flexible bodies that can store and release energy like the exoskeletons of insects. Others incorporate energy-harvesting technologies that allow them to recharge their batteries using ambient energy sources such as solar power or vibrations.</p>
    
    <h4>Paragraph G</h4>
    <p>The potential applications of insect-inspired robots are vast and varied. In search and rescue operations, small, agile robots could navigate through rubble to locate survivors in collapsed buildings. In agriculture, swarms of robots could monitor crop health, apply pesticides precisely where needed, and even pollinate plants in the event of bee population declines. In medicine, tiny robots inspired by insects could be used for minimally invasive surgeries or to deliver drugs to specific locations in the body. In space exploration, robots that can adapt to unknown environments and work in swarms could be invaluable for exploring other planets or moons where conditions are harsh and communication with Earth is limited.</p>
    
    <h4>Paragraph H</h4>
    <p>Despite the progress that has been made, there are still significant challenges in developing insect-inspired robots. One major obstacle is the complexity of insect biology. Insects have evolved over millions of years to become highly optimized machines, and replicating their capabilities requires solving numerous engineering problems simultaneously. Additionally, there are practical limitations in terms of materials, sensors, and actuators. Current technology often cannot match the performance of biological systems in terms of weight, power consumption, and durability. Nevertheless, the field of insect-inspired robotics continues to advance rapidly, driven by improvements in materials science, miniaturization, and computational power. As these technologies continue to improve, we can expect to see increasingly sophisticated insect-inspired robots that may eventually rival or even surpass their biological counterparts.</p>
    
  </section>
  <div id="divider" title="Drag to resize"></div>
  <section class="pane" id="right">
    <h3>Questions</h3>
    
    <div class="group">
      <h4>Questions 27‚Äì32</h4>
      <p>Reading Passage 3 has eight paragraphs, A‚ÄìH.</p>
      <p>Which paragraph contains the following information?</p>
      <p>Write the correct letter, A‚ÄìH, in boxes 27‚Äì32 on your answer sheet.</p>
      
      <div id="q27-anchor">
        <p><span class="q-item">27</span> &nbsp;&nbsp;&nbsp; A reference to the potential applications of insect-inspired robots<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q27" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q27" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q27" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q27" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q27" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q27" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q27" value="G"> G &nbsp;&nbsp;&nbsp;
        <input type="radio" name="q27" value="H"> H</p>
      </div>
      
      <div id="q28-anchor">
        <p><span class="q-item">28</span> &nbsp;&nbsp;&nbsp; A reference to the advantages of swarm intelligence<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q28" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q28" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q28" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q28" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q28" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q28" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q28" value="G"> G &nbsp;&nbsp;&nbsp;
        <input type="radio" name="q28" value="H"> H</p>
      </div>
      
      <div id="q29-anchor">
        <p><span class="q-item">29</span> &nbsp;&nbsp;&nbsp; A reference to the challenges in replicating insect flight<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q29" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q29" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q29" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q29" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q29" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q29" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q29" value="G"> G &nbsp;&nbsp;&nbsp;
        <input type="radio" name="q29" value="H"> H</p>
      </div>
      
      <div id="q30-anchor">
        <p><span class="q-item">30</span> &nbsp;&nbsp;&nbsp; A reference to the sensory capabilities of insects<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q30" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q30" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q30" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q30" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q30" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q30" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q30" value="G"> G &nbsp;&nbsp;&nbsp;
        <input type="radio" name="q30" value="H"> H</p>
      </div>
      
      <div id="q31-anchor">
        <p><span class="q-item">31</span> &nbsp;&nbsp;&nbsp; A reference to the energy efficiency of insects<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q31" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q31" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q31" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q31" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q31" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q31" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q31" value="G"> G &nbsp;&nbsp;&nbsp;
        <input type="radio" name="q31" value="H"> H</p>
      </div>
      
      <div id="q32-anchor">
        <p><span class="q-item">32</span> &nbsp;&nbsp;&nbsp; A reference to the definition of biomimicry<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q32" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q32" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q32" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q32" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q32" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q32" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q32" value="G"> G &nbsp;&nbsp;&nbsp;
        <input type="radio" name="q32" value="H"> H</p>
      </div>
    </div>
    
    <div class="group">
      <h4>Questions 33‚Äì36</h4>
      <p>Complete each sentence with the correct ending, A‚ÄìH, below.</p>
      <p>Write the correct letter, A‚ÄìH, in boxes 33‚Äì36 on your answer sheet.</p>
      
      <div id="q33-anchor">
        <p><span class="q-item">33</span> &nbsp;&nbsp;&nbsp; Insect-inspired robots can navigate challenging terrains<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="A"> A &nbsp;&nbsp;&nbsp; thanks to their multiple legs and low center of gravity.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="B"> B &nbsp;&nbsp;&nbsp; by mimicking the walking patterns of insects.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="C"> C &nbsp;&nbsp;&nbsp; through decentralized control systems.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="D"> D &nbsp;&nbsp;&nbsp; by detecting chemical signals in the air.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="E"> E &nbsp;&nbsp;&nbsp; with enhanced sensory capabilities.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="F"> F &nbsp;&nbsp;&nbsp; by working together in large groups.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="G"> G &nbsp;&nbsp;&nbsp; through rapid wing movements.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q33" value="H"> H &nbsp;&nbsp;&nbsp; by storing and releasing energy like exoskeletons.</p>
      </div>
      
      <div id="q34-anchor">
        <p><span class="q-item">34</span> &nbsp;&nbsp;&nbsp; Robots equipped with chemical sensors<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="A"> A &nbsp;&nbsp;&nbsp; thanks to their multiple legs and low center of gravity.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="B"> B &nbsp;&nbsp;&nbsp; by mimicking the walking patterns of insects.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="C"> C &nbsp;&nbsp;&nbsp; through decentralized control systems.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="D"> D &nbsp;&nbsp;&nbsp; by detecting chemical signals in the air.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="E"> E &nbsp;&nbsp;&nbsp; with enhanced sensory capabilities.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="F"> F &nbsp;&nbsp;&nbsp; by working together in large groups.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="G"> G &nbsp;&nbsp;&nbsp; through rapid wing movements.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q34" value="H"> H &nbsp;&nbsp;&nbsp; by storing and releasing energy like exoskeletons.</p>
      </div>
      
      <div id="q35-anchor">
        <p><span class="q-item">35</span> &nbsp;&nbsp;&nbsp; Robot swarms can accomplish complex tasks<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="A"> A &nbsp;&nbsp;&nbsp; thanks to their multiple legs and low center of gravity.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="B"> B &nbsp;&nbsp;&nbsp; by mimicking the walking patterns of insects.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="C"> C &nbsp;&nbsp;&nbsp; through decentralized control systems.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="D"> D &nbsp;&nbsp;&nbsp; by detecting chemical signals in the air.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="E"> E &nbsp;&nbsp;&nbsp; with enhanced sensory capabilities.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="F"> F &nbsp;&nbsp;&nbsp; by working together in large groups.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="G"> G &nbsp;&nbsp;&nbsp; through rapid wing movements.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q35" value="H"> H &nbsp;&nbsp;&nbsp; by storing and releasing energy like exoskeletons.</p>
      </div>
      
      <div id="q36-anchor">
        <p><span class="q-item">36</span> &nbsp;&nbsp;&nbsp; Insects achieve energy efficiency<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="A"> A &nbsp;&nbsp;&nbsp; thanks to their multiple legs and low center of gravity.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="B"> B &nbsp;&nbsp;&nbsp; by mimicking the walking patterns of insects.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="C"> C &nbsp;&nbsp;&nbsp; through decentralized control systems.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="D"> D &nbsp;&nbsp;&nbsp; by detecting chemical signals in the air.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="E"> E &nbsp;&nbsp;&nbsp; with enhanced sensory capabilities.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="F"> F &nbsp;&nbsp;&nbsp; by working together in large groups.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="G"> G &nbsp;&nbsp;&nbsp; through rapid wing movements.<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q36" value="H"> H &nbsp;&nbsp;&nbsp; by storing and releasing energy like exoskeletons.</p>
      </div>
    </div>
    
    <div class="group">
      <h4>Questions 37‚Äì40</h4>
      <p>Do the following statements agree with the information given in Reading Passage 3?</p>
      <p>In boxes 37‚Äì40 on your answer sheet, write</p>
      <p><strong>TRUE</strong> &nbsp;&nbsp;&nbsp; if the statement agrees with the information<br>
      <strong>FALSE</strong> &nbsp;&nbsp;&nbsp; if the statement contradicts the information<br>
      <strong>NOT GIVEN</strong> &nbsp;&nbsp;&nbsp; if there is no information on this</p>
      
      <div id="q37-anchor">
        <p><span class="q-item">37</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q37" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q37" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q37" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Insect-inspired robots are more versatile than current robot models.</p>
      </div>
      
      <div id="q38-anchor">
        <p><span class="q-item">38</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q38" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q38" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q38" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; All insect-inspired robots can fly.</p>
      </div>
      
      <div id="q39-anchor">
        <p><span class="q-item">39</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q39" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q39" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q39" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Insect-inspired robots could be used in space exploration.</p>
      </div>
      
      <div id="q40-anchor">
        <p><span class="q-item">40</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q40" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q40" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q40" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Current technology can easily match the performance of biological systems.</p>
      </div>
    </div>
    
    <div style="display:flex;gap:8px;margin-bottom:10px;">
      <button class="primary" onclick="grade()">Submit</button>
      <button onclick="resetForm()">Reset</button>
      <button onclick="toggleNotes()">Notes</button>
    </div>
    <div id="results"></div>
    <details class="answerbox" id="answerBox">
      <summary>Show answers (click to toggle) <span class="badge">hidden</span></summary>
      <div id="answerContent"></div>
    </details>
  </section>
</div>

<div aria-label="Selection tools" id="selbar" role="toolbar">
  <button id="btnHL">Highlight</button>
  <button id="btnUH">Remove</button>
  <button id="btnNote">Note</button>
</div>

<div id="notes">
  <header>
    <strong>Notes</strong>
    <div>
      <button id="btnCopy">Copy</button>
      <button id="btnClose">Close</button>
    </div>
  </header>
  <textarea id="noteArea" placeholder="Type your notes here..."></textarea>
</div>

<div id="toast"></div>

<script>
// È°µÈù¢ÊªöÂä®ÂäüËÉΩ
function scrollToElement(id) {
  const element = document.getElementById(id);
  if (element) {
    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
    // È´ò‰∫ÆÊòæÁ§∫È¢òÁõÆ
    element.style.backgroundColor = '#e0e7ff';
    setTimeout(() => {
      element.style.backgroundColor = '';
    }, 1000);
  }
}

// ÈáçÁΩÆË°®ÂçïÂäüËÉΩ
function resetForm() {
  // ÈáçÁΩÆÂçïÈÄâÊåâÈíÆ
  document.querySelectorAll('input[type="radio"]').forEach(radio => {
    radio.checked = false;
  });
  
  // ÈáçÁΩÆÊñáÊú¨ËæìÂÖ•Ê°Ü
  document.querySelectorAll('input.blank').forEach(input => {
    input.value = '';
  });
  
  // Ê∏ÖÈô§ÁªìÊûú
  document.getElementById('results').innerHTML = '';
  
  // Êõ¥Êñ∞ÂØºËà™Áä∂ÊÄÅ
  updateAnswerStatus();
  
  showToast('Form reset');
}

// ToastÈÄöÁü•ÂäüËÉΩ
function showToast(msg) {
  const toastEl = document.getElementById('toast');
  toastEl.textContent = msg;
  toastEl.style.display = 'block';
  setTimeout(() => {
    toastEl.style.display = 'none';
  }, 1500);
}

// ËÆ°Êó∂Âô®ÂäüËÉΩ
let _t = 0;
let timerRunning = true;
let timerInterval;
const _timerEl = document.getElementById('timer');

function updateTimer() {
  const m = Math.floor(_t / 60);
  const s = _t % 60;
  _timerEl.textContent = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
}

function startTimer() {
  timerInterval = setInterval(() => {
    if (timerRunning) {
      _t++;
      updateTimer();
    }
  }, 1000);
}

function toggleTimer() {
  if (timerRunning) {
    clearInterval(timerInterval);
    timerRunning = false;
    _timerEl.classList.add('paused');
    showToast('Timer paused');
  } else {
    startTimer();
    timerRunning = true;
    _timerEl.classList.remove('paused');
    showToast('Timer resumed');
  }
}

// ‰∏ªÈ¢òÂàáÊç¢ÂäüËÉΩ
function toggleTheme() {
  document.body.classList.toggle('dark');
  const isDark = document.body.classList.contains('dark');
  localStorage.setItem('darkMode', isDark);
  const themeButton = document.querySelector('.theme-toggle');
  themeButton.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
}

// ÊãñÊãΩÂàÜÊ†èÂäüËÉΩ
var divider = document.getElementById('divider');
var left = document.getElementById('left');
var right = document.getElementById('right');
var dragging = false;

function startDrag(e) {
  dragging = true;
  document.body.style.cursor = 'ew-resize';
  if (e.preventDefault) e.preventDefault();
}

function endDrag() {
  dragging = false;
  document.body.style.cursor = '';
}

function onMove(clientX) {
  var container = document.querySelector('.shell').getBoundingClientRect();
  var x = clientX - container.left;
  x = Math.max(280, Math.min(container.width - 320, x));
  left.style.flex = '0 0 ' + x + 'px';
  right.style.flex = '1 1 auto';
}

divider.addEventListener('mousedown', function(e) { startDrag(e); });
window.addEventListener('mousemove', function(e) { if (dragging) onMove(e.clientX); });
window.addEventListener('mouseup', endDrag);
divider.addEventListener('touchstart', function(e) { startDrag(e.touches[0]); }, { passive: false });
window.addEventListener('touchmove', function(e) { if (dragging) onMove(e.touches[0].clientX); }, { passive: false });
window.addEventListener('touchend', endDrag);

// È´ò‰∫ÆÂíåÁ¨îËÆ∞ÂäüËÉΩ
var selbar = document.getElementById('selbar');
var btnHL = document.getElementById('btnHL');
var btnUH = document.getElementById('btnUH');
var btnNote = document.getElementById('btnNote');
var lastRange = null;
var currentHlNode = null;
var keepToolbar = false;

function positionSelbarForRect(rect) {
  selbar.style.display = 'flex';
  requestAnimationFrame(function() {
    var top = window.scrollY + rect.top - selbar.offsetHeight - 8;
    var leftPos = window.scrollX + rect.left + rect.width/2 - selbar.offsetWidth/2;
    selbar.style.top = ((top > 0) ? top : (window.scrollY + rect.bottom + 8)) + 'px';
    selbar.style.left = Math.max(8, leftPos) + 'px';
  });
}

function updateSelbar() {
  var sel = window.getSelection();
  if (!sel || sel.rangeCount === 0 || sel.isCollapsed) {
    selbar.style.display = 'none';
    currentHlNode = null;
    return;
  }
  var range = sel.getRangeAt(0);
  lastRange = range.cloneRange();
  currentHlNode = null;
  positionSelbarForRect(range.getBoundingClientRect());
}

document.getElementById('left').addEventListener('mouseup', updateSelbar);
document.getElementById('right').addEventListener('mouseup', updateSelbar);
document.addEventListener('selectionchange', function() {
  var sel = window.getSelection();
  if (!sel || sel.rangeCount === 0 || sel.isCollapsed) {
    if (!keepToolbar && !currentHlNode) {
      selbar.style.display = 'none';
    }
  }
});
document.addEventListener('scroll', function() {
  if (selbar.style.display === 'flex') updateSelbar();
});

document.addEventListener('mousedown', function(e) {
  var t = e.target;
  if (t.classList && t.classList.contains('hl')) {
    keepToolbar = true;
  } else {
    keepToolbar = false;
  }
}, true);

document.addEventListener('click', function(e) {
  var target = e.target;
  if (target.classList && target.classList.contains('hl')) {
    currentHlNode = target;
    lastRange = null;
    positionSelbarForRect(target.getBoundingClientRect());
    var sel = window.getSelection();
    if (sel) sel.removeAllRanges();
    setTimeout(function() { keepToolbar = false; }, 0);
  }
}, true);

function doHighlight() {
  if (currentHlNode) return;
  if (!lastRange || lastRange.collapsed) return;
  
  const startNode = lastRange.startContainer;
  const endNode = lastRange.endContainer;
  
  if (startNode === endNode) {
    try {
      const span = document.createElement('span');
      span.className = 'hl';
      lastRange.surroundContents(span);
      selbar.style.display = 'none';
      showToast('Highlighted');
      return;
    } catch (e) {}
  }
  
  const fragment = lastRange.cloneContents();
  const div = document.createElement('div');
  div.appendChild(fragment);
  
  function processNode(node) {
    if (node.nodeType === Node.TEXT_NODE) {
      if (node.textContent.trim().length > 0) {
        const span = document.createElement('span');
        span.className = 'hl';
        span.textContent = node.textContent;
        return span;
      }
      return node;
    }
    
    if (node.nodeType === Node.ELEMENT_NODE) {
      const isBlock = window.getComputedStyle(node).display.includes('block') ||
        ['P', 'H1', 'H2', 'H3', 'H4', 'DIV'].includes(node.tagName);
      
      const wrapper = isBlock ? document.createElement(node.tagName.toLowerCase()) : document.createElement('span');
      wrapper.className = isBlock ? node.className + ' hl' : 'hl';
      
      Array.from(node.attributes).forEach(attr => {
        wrapper.setAttribute(attr.name, attr.value);
      });
      
      while (node.firstChild) {
        const processedChild = processNode(node.firstChild);
        wrapper.appendChild(processedChild);
      }
      
      return wrapper;
    }
    
    return node;
  }
  
  const highlightedContent = processNode(div);
  lastRange.deleteContents();
  lastRange.insertNode(highlightedContent);
  
  selbar.style.display = 'none';
  showToast('Highlighted');
}

function removeHighlight() {
  if (currentHlNode) {
    const parent = currentHlNode.parentNode;
    while (currentHlNode.firstChild) {
      parent.insertBefore(currentHlNode.firstChild, currentHlNode);
    }
    parent.removeChild(currentHlNode);
    parent.normalize();
    currentHlNode = null;
    selbar.style.display = 'none';
    showToast('Highlight removed');
    return;
  }
  
  if (!lastRange) return;
  
  const selRect = lastRange.getBoundingClientRect();
  const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_ELEMENT);
  const toRemove = [];
  
  while (walker.nextNode()) {
    const node = walker.currentNode;
    if (node.classList && node.classList.contains('hl')) {
      const rect = node.getBoundingClientRect();
      if (!(rect.right < selRect.left || rect.left > selRect.right ||
        rect.bottom < selRect.top || rect.top > selRect.bottom)) {
        toRemove.push(node);
      }
    }
  }
  
  toRemove.forEach(el => {
    const parent = el.parentNode;
    while (el.firstChild) {
      parent.insertBefore(el.firstChild, el);
    }
    parent.removeChild(el);
    parent.normalize();
  });
  
  selbar.style.display = 'none';
  showToast('Highlight removed');
}

btnHL.addEventListener('click', doHighlight);
btnUH.addEventListener('click', removeHighlight);

// Á¨îËÆ∞ÂäüËÉΩ
var notes = document.getElementById('notes');
var noteArea = document.getElementById('noteArea');
var btnCopy = document.getElementById('btnCopy');
var btnClose = document.getElementById('btnClose');

function toggleNotes() {
  notes.style.display = (notes.style.display === 'flex' ? 'none' : 'flex');
}
window.toggleNotes = toggleNotes;

btnClose.addEventListener('click', toggleNotes);
btnCopy.addEventListener('click', async function() {
  await navigator.clipboard.writeText(noteArea.value || '');
  showToast('Copied');
});

btnNote.addEventListener('click', function() {
  var text = '';
  if (currentHlNode) {
    text = (currentHlNode.textContent || '').trim();
  } else if (lastRange) {
    var frag = lastRange.cloneContents();
    text = (frag.textContent || '').trim();
  }
  toggleNotes();
  if (text) {
    noteArea.value = (noteArea.value ? noteArea.value + '\n' : '') + '> ' + text + '\n';
  }
  selbar.style.display = 'none';
});

// Á≠îÈ¢òÁä∂ÊÄÅÊõ¥Êñ∞
function updateAnswerStatus() {
  for (let i = 27; i <= 40; i++) {
    const inputs = document.querySelectorAll(`input[name="q${i}"]`);
    const navItem = document.getElementById(`q${i}-nav`);
    if (navItem) {
      let answered = false;
      inputs.forEach(input => {
        if ((input.type === 'radio' || input.type === 'checkbox') && input.checked) {
          answered = true;
        } else if (input.type === 'text' && input.value.trim()) {
          answered = true;
        }
      });
      if (answered) {
        navItem.classList.add('answered');
      } else {
        navItem.classList.remove('answered');
      }
    }
  }
}

// Á≠îÊ°àÂíåËØÑÂàÜÁ≥ªÁªü
var answers = {
  "q27": "G", "q28": "D", "q29": "E", "q30": "C", "q31": "F", "q32": "A",
  "q33": "A", "q34": "D", "q35": "F", "q36": "H",
  "q37": "TRUE", "q38": "FALSE", "q39": "TRUE", "q40": "FALSE"
};

function grade() {
  var total = 0, correct = 0, lines = [];
  
  // Ê£ÄÊü•ÂçïÈÄâÈ¢ò (27-40)
  for (let n = 27; n <= 40; n++) {
    const q = `q${n}`;
    total++;
    const selected = document.querySelector(`input[name="${q}"]:checked`);
    const userAnswer = selected ? selected.value : '';
    const isCorrect = userAnswer === answers[q];
    if (isCorrect) correct++;
    lines.push(`${q.toUpperCase()}: ${userAnswer || 'None'} ${isCorrect ? '‚úì' : '‚úó'}`);
  }
  
  // ÊòæÁ§∫ÁªìÊûú
  const acc = Math.round(100 * correct / total);
  document.getElementById('results').innerHTML = `
    <p><strong>Score:</strong> ${correct}/${total} <span class="badge">Accuracy ${acc}%</span></p>
    <pre>${lines.join('\n')}</pre>
  `;
  
  // ÊòæÁ§∫Á≠îÊ°à
  document.getElementById('answerContent').innerHTML = `
    <ol>
      <li>27 ‚Üí G</li>
      <li>28 ‚Üí D</li>
      <li>29 ‚Üí E</li>
      <li>30 ‚Üí C</li>
      <li>31 ‚Üí F</li>
      <li>32 ‚Üí A</li>
      <li>33 ‚Üí A</li>
      <li>34 ‚Üí D</li>
      <li>35 ‚Üí F</li>
      <li>36 ‚Üí H</li>
      <li>37 ‚Üí TRUE</li>
      <li>38 ‚Üí FALSE</li>
      <li>39 ‚Üí TRUE</li>
      <li>40 ‚Üí FALSE</li>
    </ol>
  `;
  document.querySelector('#answerBox .badge').textContent = 'tap to view';
  
  updateAnswerStatus();
}

// ÁõëÂê¨Á≠îÊ°àÂèòÂåñ
document.addEventListener('change', updateAnswerStatus);
document.addEventListener('input', updateAnswerStatus);

// È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
document.addEventListener('DOMContentLoaded', function() {
  startTimer();
  updateAnswerStatus(); // ÂàùÂßãÂåñÁ≠îÈ¢òÁä∂ÊÄÅ
  
  // Âä†ËΩΩ‰øùÂ≠òÁöÑ‰∏ªÈ¢ò
  if (localStorage.getItem('darkMode') === 'true') {
    document.body.classList.add('dark');
    document.querySelector('.theme-toggle').textContent = '‚òÄÔ∏è';
  }
});

// ÁªÉ‰π†È°µÈù¢Â¢ûÂº∫ËÑöÊú¨ÈõÜÊàê
function loadPracticePageEnhancer() {
  const script = document.createElement('script');
  script.src = '../../../js/practice-page-enhancer.js';
  script.onload = function() {
    console.log('ÁªÉ‰π†È°µÈù¢Â¢ûÂº∫ËÑöÊú¨Â∑≤Âä†ËΩΩ');
  };
  script.onerror = function() {
    console.error('ÁªÉ‰π†È°µÈù¢Â¢ûÂº∫ËÑöÊú¨Âä†ËΩΩÂ§±Ë¥•');
    // ÈôçÁ∫ßÂà∞ÂÜÖËÅîÂ¢ûÂº∫
    loadInlineEnhancer();
  };
  document.head.appendChild(script);
}

// ÂÜÖËÅîÂ¢ûÂº∫Âô®ÔºàÈôçÁ∫ßÊñπÊ°àÔºâ
function loadInlineEnhancer() {
  if (window.practicePageEnhancer) return;
  
  window.practicePageEnhancer = {
    initialize: function() {
      console.log('[InlineEnhancer] ÂÜÖËÅîÂ¢ûÂº∫Âô®Â∑≤ÂàùÂßãÂåñ');
      this.setupCommunication();
      this.setupAnswerListeners();
      this.interceptSubmit();
    },
    
    setupCommunication: function() {
      this.parentWindow = window.opener || window.parent;
      window.addEventListener('message', (event) => {
        if (event.data && event.data.type === 'INIT_SESSION') {
          this.sessionId = event.data.data.sessionId;
          this.sendMessage('SESSION_READY', {
            pageType: this.detectPageType(),
            url: window.location.href
          });
        }
      });
    },
    
    detectPageType: function() {
      const title = document.title || '';
      if (title.includes('P1')) return 'P1';
      if (title.includes('P2')) return 'P2';
      if (title.includes('P3')) return 'P3';
      return 'unknown';
    },
    
    setupAnswerListeners: function() {
      this.answers = {};
      this.startTime = Date.now();
      
      document.addEventListener('change', (e) => {
        if (e.target.name && e.target.name.startsWith('q')) {
          this.answers[e.target.name] = e.target.value;
        }
      });
      
      document.addEventListener('input', (e) => {
        if (e.target.name && e.target.name.startsWith('q')) {
          this.answers[e.target.name] = e.target.value;
        }
      });
    },
    
    interceptSubmit: function() {
      // Êã¶Êà™gradeÂáΩÊï∞
      if (typeof window.grade === 'function') {
        const originalGrade = window.grade;
        window.grade = () => {
          const result = originalGrade();
          setTimeout(() => this.handleSubmit(), 200);
          return result;
        };
      }
      
      // ÁõëÂê¨Êèê‰∫§ÊåâÈíÆ
      document.addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON' &&
          (e.target.textContent.includes('Submit') ||
            e.target.onclick && e.target.onclick.toString().includes('grade'))) {
          setTimeout(() => this.handleSubmit(), 300);
        }
      });
    },
    
    handleSubmit: function() {
      const results = {
        sessionId: this.sessionId,
        startTime: this.startTime,
        endTime: Date.now(),
        duration: Math.round((Date.now() - this.startTime) / 1000),
        answers: this.answers,
        scoreInfo: this.extractScore(),
        pageType: this.detectPageType(),
        url: window.location.href
      };
      
      this.sendMessage('PRACTICE_COMPLETE', results);
    },
    
    extractScore: function() {
      const resultsEl = document.getElementById('results');
      if (!resultsEl) return null;
      
      const text = resultsEl.textContent || '';
      const scoreMatch = text.match(/Score:\s*(\d+)\/(\d+)/i);
      if (scoreMatch) {
        const correct = parseInt(scoreMatch[1]);
        const total = parseInt(scoreMatch[2]);
        return {
          correct: correct,
          total: total,
          accuracy: total > 0 ? correct / total : 0,
          percentage: Math.round((correct / total) * 100),
          source: 'inline_extraction'
        };
      }
      return null;
    },
    
    sendMessage: function(type, data) {
      if (this.parentWindow) {
        this.parentWindow.postMessage({
          type: type,
          data: data,
          source: 'practice_page'
        }, '*');
      }
    }
  };
  
  // ÂàùÂßãÂåñ
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      window.practicePageEnhancer.initialize();
    });
  } else {
    window.practicePageEnhancer.initialize();
  }
}

// Âä†ËΩΩÂ¢ûÂº∫ËÑöÊú¨
loadPracticePageEnhancer();
</script>

</body>
</html>