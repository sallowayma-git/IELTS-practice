<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>IELTS Reading Practice - The Gender Gap in New Zealand</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --line: #e5e7eb;
            --bg: #f6f7fb;
            --panel: #fff;
            --accent: #3b82f6;
            --muted: #6b7280;
            --shadow: 0 6px 20px rgba(0,0,0,.12);
            --text-color: #333;
            --highlight: #fff3a3;
            --selbar-bg: #111;
            --selbar-text: #fff;
        }

        body.dark-mode {
            --line: #4a4a4a;
            --bg: #1a1a1a;
            --panel: #2a2a2a;
            --muted: #bbb;
            --text-color: #f0f0f0;
            --highlight: #5b21b6;
            --selbar-bg: #1f2937;
            --selbar-text: #e5e7eb;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        html { font-size: 16px; scroll-behavior: smooth;}
        html.font-regular { font-size: 16px; }
        html.font-large { font-size: 18px; }
        html.font-xlarge { font-size: 20px; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
            background: var(--bg);
            color: var(--text-color);
            height: 100vh;
            overflow: hidden;
            transition: background-color 0.3s ease;
            padding-bottom: 64px;
        }

        .header {
            background-color: var(--panel);
            padding: 12px 20px;
            border-bottom: 1px solid var(--line);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 100;
            box-shadow: 0 1px 3px rgba(0,0,0,.05);
        }

        .header-content { display: flex; align-items: center; gap: 16px; }
        .header h1 { font-size: 1.2rem; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: var(--text-color); }
        #timer { font-size: 1rem; font-weight: 500; background: var(--bg); padding: 6px 12px; border-radius: 6px; border: 1px solid var(--line); min-width: 90px; text-align: center; color: var(--text-color); }
        .header-controls { display: flex; align-items: center; gap: 10px; }
        .header-btn { background: var(--panel); border: 1px solid var(--line); border-radius: 6px; padding: 6px 12px; cursor: pointer; font-size: 0.9rem; transition: all 0.2s ease; color: var(--text-color); }
        .header-btn:hover { background: var(--bg); border-color: var(--accent); }

        #settings-panel {
            position: absolute; top: 60px; right: 20px; width: 200px; background: var(--panel); border-radius: 12px;
            box-shadow: var(--shadow); border: 1px solid var(--line); z-index: 1000; padding: 8px; display: none;
        }
        .settings-group { margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid var(--line); }
        .settings-group:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
        .settings-title { font-size: 0.85rem; color: var(--muted); margin-bottom: 8px; padding-left: 12px; }
        .settings-option { display: block; width: 100%; text-align: left; padding: 8px 12px; border: none; background: none; cursor: pointer; font-size: 0.9rem; border-radius: 6px; color: var(--text-color); }
        .settings-option.active { background: #e9effd; color: var(--accent); font-weight: 500; }
        .dark-mode .settings-option.active { background: #1e3a8a; }

        #notes-panel {
            position: fixed; right: 12px; bottom: 76px; width: 320px; height: 45vh; background: var(--panel); border: 1px solid var(--line); border-radius: 12px;
            display: none; flex-direction: column; z-index: 900; box-shadow: var(--shadow); overflow: hidden;
        }
        #notes-panel header { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; border-bottom: 1px solid var(--line); background-color: var(--bg); }
        #notes-panel h3 { font-size: 1rem; font-weight: 600; color: var(--text-color); margin: 0; }
        #notes-panel textarea { flex: 1; border: 0; padding: 16px; resize: none; font-size: 0.95rem; background: transparent; color: var(--text-color); line-height: 1.6; }
        #notes-panel textarea:focus { outline: none; }
        #close-note { padding: 4px 8px; border-radius: 4px; border: 1px solid var(--line); background: transparent; cursor: pointer; color: var(--text-color); transition: background-color 0.2s; }
        #close-note:hover { background-color: rgba(0,0,0,0.05); }
        .dark-mode #close-note:hover { background-color: rgba(255,255,255,0.1); }

        .overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.08); z-index: 800; display: none; backdrop-filter: blur(2px); }
        .dark-mode .overlay { background: rgba(0, 0, 0, 0.3); }

        .shell { display: flex; height: calc(100vh - 58px - 64px); width: 100%; overflow: hidden; }
        .pane { background: var(--panel); overflow: auto; padding: 24px; transition: width 0.1s ease; }
        #left { min-width: 280px; max-width: calc(100% - 280px); width: 50%; }
        #right { min-width: 280px; flex: 1; background: var(--bg); border-left: 1px solid var(--line); }
        .dark-mode #right { background: #1e293b; }

        #divider { flex: 0 0 8px; background: var(--bg); cursor: ew-resize; user-select: none; position: relative; border-left: 1px solid var(--line); border-right: 1px solid var(--line); }
        #divider::before { content: ""; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 4px; height: 30px; border-radius: 2px; background: rgba(100, 100, 100, 0.2); }
        #divider:hover { background: #dbeafe; }

        h2, h3, h4, h5 { margin: 0 0 16px; color: var(--text-color); }
        #left p, #right p { margin: 0 0 16px; line-height: 1.7; }
        #left strong { font-weight: 600; }
        .empty-space { height: 40px; }

        .group { background: var(--panel); border: 1px solid var(--line); border-radius: 10px; padding: 20px; margin-bottom: 20px; }

        .summary-completion { border: 1px solid var(--line); border-radius: 8px; padding: 20px; }
        .summary-completion h4 { margin-top: 0; }
        .summary-completion p { line-height: 2.2; }
        .summary-completion input { border: none; border-bottom: 1px solid #9ca3af; padding: 2px 8px; font-size: 1em; background: transparent; color: var(--text-color); width: 150px; text-align: center; }
        .dark-mode .summary-completion input { border-bottom-color: #666; }
        .summary-completion input:focus { outline: none; border-bottom: 2px solid var(--accent); }

        .matching-table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 0.9rem; }
        .matching-table th, .matching-table td { border: 1px solid var(--line); padding: 8px; text-align: left; vertical-align: middle; }
        .matching-table th { background-color: var(--bg); font-weight: bold; text-align: center; }
        .matching-table td:not(:first-child) { text-align: center; }
        .matching-table input[type="radio"] { cursor: pointer; transform: scale(1.2); }
        .dark-mode .matching-table td { border-color: #4a4a4a; }

        .options-pool { background: #fafbfc; border: 1px solid var(--line); border-radius: 8px; padding: 12px; margin-top: 16px; min-height: 50px; }
        .dark-mode .options-pool { background: #334155; }
        .pool-items { display: flex; flex-wrap: wrap; gap: 8px; }
        .drag-item { padding: 6px 12px; background-color: #eef2ff; border: 1px solid #c7d2fe; border-radius: 6px; cursor: grab; user-select: none; font-size: 14px; transition: all 0.2s; color: #333; }
        .dark-mode .drag-item { background-color: #4f46e5; border-color: #6366f1; color: #fff; }
        .drag-item.dragging { opacity: 0.5; }

        /* --- MODIFIED STYLE FOR WIDER DROPZONE --- */
        .match-question-item {
            display: grid;
            grid-template-columns: auto 1fr; /* Person's name takes auto width, dropzone takes the rest */
            align-items: center;
            gap: 16px; /* Increased gap for better spacing */
            line-height: 1.5;
            padding: 12px 0;
            border-bottom: 1px dashed var(--line);
        }
        .match-question-item p { margin: 0; white-space: nowrap; } /* Prevent name from wrapping */
        .match-question-item:last-child { border-bottom: none; }
        
        .match-dropzone {
            width: 100%;
            min-height: 42px;
            border: 2px dashed #9ca3af;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: flex-start; /* Align item to the start */
            transition: all 0.2s;
            padding: 4px 8px; /* Added horizontal padding */
        }
        .match-dropzone.drag-over { border-color: var(--accent); background: #eff6ff; }
        .dark-mode .match-dropzone.drag-over { background: #1e3a8a; }
        .match-dropzone .drag-item {
            cursor: grab; /* Allow dragging out */
            font-size: 13px; /* Slightly larger font for readability */
            text-align: left;
            width: 100%;
            white-space: normal; /* Allow text to wrap */
        }

        #results { background: var(--panel); border: 1px solid var(--line); border-radius: 10px; padding: 20px; margin-top: 20px; display: none; line-height: 1.8; }
        .results-table { width: 100%; border-collapse: collapse; margin-top: 12px; font-size: 0.9rem; }
        .results-table th, .results-table td { border: 1px solid var(--line); padding: 8px; text-align: center; }
        .results-table th { background: var(--bg); }
        .result-correct { color: #10b981; font-weight: bold; }
        .result-incorrect { color: #ef4444; font-weight: bold; }

        .hl { background: var(--highlight); box-shadow: inset 0 -2px 0 rgba(0,0,0,.05); cursor: pointer; }
        .dark-mode .hl { color: #f5f3ff; }

        #selbar { position: absolute; display: none; z-index: 6000; background: var(--selbar-bg); color: var(--selbar-text); border-radius: 8px; padding: 6px; box-shadow: var(--shadow); font-size: 13px; gap: 6px; align-items: center; }
        #selbar button { background: transparent; color: var(--selbar-text); border: 1px solid rgba(255,255,255,.25); padding: 4px 8px; border-radius: 6px; cursor: pointer; }
        #selbar button:hover { border-color: var(--selbar-text); }

        .practice-nav { background: var(--panel); padding: 12px 20px; display: flex; align-items: center; gap: 16px; box-shadow: 0 -2px 4px rgba(0,0,0,.05); flex-wrap: wrap; position: fixed; left: 0; right: 0; bottom: 0; border-top: 1px solid var(--line); z-index: 4000; }
        .practice-nav .title { font-weight: 600; color: var(--muted); }
        .practice-nav .questions { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
        .practice-nav .q-item { padding: 6px 10px; border: 1px solid var(--line); border-radius: 6px; background: var(--panel); cursor: pointer; font-size: 14px; transition: all 0.2s; min-width: 36px; text-align: center; color: var(--text-color); }
        .practice-nav .q-item:hover { background: var(--bg); border-color: var(--accent); }
        .practice-nav .q-item.answered { background: #e0e7ff; border-color: var(--accent); color: var(--accent); font-weight: 500; }
        .dark-mode .practice-nav .q-item.answered { background: #3949ab; border-color: var(--accent); color: #e8eaf6; }
        .practice-nav .q-item.correct { background: #dcfce7; border-color: #4ade80; color: #15803d; }
        .dark-mode .practice-nav .q-item.correct { background: #166534; border-color: #4ade80; color: #dcfce7; }
        .practice-nav .q-item.incorrect { background: #fee2e2; border-color: #f87171; color: #b91c1c; }
        .dark-mode .practice-nav .q-item.incorrect { background: #991b1b; border-color: #f87171; color: #fee2e2; }

        .practice-nav .controls { margin-left: auto; display: flex; align-items: center; gap: 12px; }
        .practice-nav .controls button { padding: 8px 12px; border: 1px solid var(--line); border-radius: 6px; background: var(--panel); cursor: pointer; color: var(--text-color); }
        .practice-nav .controls button.primary { background: var(--accent); color: #fff; border-color: var(--accent); }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1>Reading Passage 2 - The Gender Gap</h1>
            <div id="timer">00:00</div>
        </div>
        <div class="header-controls">
            <button class="header-btn" id="size-btn">Size</button>
            <button class="header-btn" id="color-btn">Color</button>
            <button class="header-btn" id="note-btn">Note</button>
        </div>
    </header>

    <div id="settings-panel">
        <div class="settings-group">
            <div class="settings-title">Font Size</div>
            <button class="settings-option active" data-size="regular">Regular</button>
            <button class="settings-option" data-size="large">Large</button>
            <button class="settings-option" data-size="xlarge">Extra Large</button>
        </div>
        <div class="settings-group">
            <div class="settings-title">Color Mode</div>
            <button class="settings-option active" data-mode="light">Black on White</button>
            <button class="settings-option" data-mode="dark">White on Black</button>
        </div>
    </div>

    <div id="notes-panel">
        <header>
            <h3>Notes</h3>
            <button id="close-note">Close</button>
        </header>
        <textarea placeholder="Write your notes here..."></textarea>
    </div>

    <div class="overlay"></div>

    <div class="shell">
        <section class="pane" id="left">
            <h2>READING PASSAGE 2</h2>
            <p>You should spend about 20 minutes on Questions 14–26, which are based on Reading Passage 2 below.</p>
            <h3>The gender gap in New Zealand's high school examination results</h3>
            <h4>Results from New Zealand's new national examinations for secondary schools are giving that country some cause for concern.</h4>

            <p><strong>A</strong> The issue is the difference in pass rates between the sexes: at each level of the examination and across all school types, the difference is about 10 percentage points. Girls are doing better in every subject, and those in girls-only schools are taking top honours. The results are not a surprise: high school girls have been outperforming boys academically for more than a decade. It is an international phenomenon, and within Australia was the subject of much debate and controversy. Within New Zealand back in the 1980s, there was a concerted campaign, called 'Girls Can Do Anything', which was aimed at lifting girls' participation rates, achievement levels and aspirations. This was so successful that the pendulum has now swung to the other extreme. Views differ on how worried people should be. After all, for much of history, girls were excluded from any form of education, and this new phenomenon could be seen as a temporary over-correction before the balance is righted.</p>
            <p><strong>B</strong> However the New Zealand State Ministry of Education says it is taking the issue seriously. It is working with a reference group on boys' education which has been set up, and it has commissioned an Australian academic to report on interventions that have been found to work for boys, drawing particularly on Australia's experience. But some, such as former prison manager Celia Lashlie, the author of a book for parents of teenage boys, believe there is still resistance within the Education Ministry towards doing anything about the problem.</p>
            <p><strong>C</strong> Education Ministry learning policy manager Steve Benson says that the 'National Certificate in Educational Achievement', or NCEA, as New Zealand's high school exams are called, is useful to employers and to universities because it provides a fine-grained picture of pupils' performance in every aspect of a subject, rather than just a pass or fail in an overall area. ‘In most parts of the curriculum, for example in maths, there isn't really a gender gap. But literacy is a different matter. Even boys who are good at writing tend not to write so much. There's actually a quantity issue.'</p>
            <p><strong>D</strong> The discrepancy in reading and writing skills between males and females shows up as early as preschool, and the difference is clear by the time these children enter high school. Not being good at literacy was not such a problem in the old days when many students left school for manual jobs after Year 11. But nowadays many more stay on to higher education, and almost all jobs require literacy skills. Roger Moses, the headmaster of Wellington College, says that the written content of NCEA papers is more demanding than the previous system of secondary school qualifications in New Zealand, even in subjects such as statistics and accounting.</p>
            <p><strong>E</strong> New Zealand 15-year-olds do very well in international reading tests, but beneath this average lies a wide variance, with New Zealand European girls most represented at the top and New Zealand Pacific Island boys at the bottom. Yet some European girls drop out, and some Pacific Island boys excel. In other words, the range in performance within each gender group is much greater than the gender differences. Ethnic differences, and differences in socio-economic status, may be more significant than the simple boy/girl explanation.</p>
            <p><strong>F</strong> This makes the Education Ministry nervous about pushing solutions that emphasise stereotyped gender differences, rather than looking at underachievement as a whole. Rob Burroughs, principal of Linwood High School in Christchurch, agrees. For three years his school ran separate boys' classes to try to address the disparity in performance, before abandoning them. The research showed that the boys did better in their own class than in the co-educational environment. But when he looked at which teachers they had, and how well those teachers' other classes did, it became clear that the difference was, instead, to do with the quality of instruction.</p>
            <p><strong>G</strong> At Onslow College, Dr Stuart Martin would do away with the NCEA Level 1 exam if he could. He says that in Year 11, aged 15, boys are simply not mature enough to cope. 'They tend to think that just passing is enough, and that it's not necessary to work hard for a Merit or an Excellence grade. Often they are busy with other activities and part-time jobs. Boys' competitive instinct tends to come out later in their schooling years, especially if there is money attached or other tangible rewards. By 17, boys are catching up academically with the girls, and by the end of Year 13, boys are again winning the top prizes.'</p>
            <p><strong>H</strong> Boys in single-sex schools do better in NCEA across all levels, something economist Brian Easton reported after analysing data from the first year of NCEA's implementation. He said the results were valid, even when socio-economic status was taken into account. Dr Paul Baker, head of Waitaki Boys' High School in Oamaru, agrees. He thinks that although it is possible for all schools to do more to boost boys' performance, it is easier in a boys' school, where activities cannot be ‘captured by girls'.</p>

            <div class="empty-space"></div>
        </section>

        <div id="divider"></div>

        <section class="pane" id="right">
            <h3>Questions</h3>

            <div class="group" id="q14-16-anchor">
                <h4>Questions 14–16</h4>
                <p>Complete the summary below.</p>
                <p>Choose <strong>NO MORE THAN TWO WORDS</strong> from the passage for each answer.</p>

                <div class="summary-completion">
                    <h4>High school assessment in New Zealand</h4>
                    <p>
                        New Zealanders are worried at the outcomes of their high school assessment system, because the <strong>14</strong> <input type="text" id="q14_input"> of girls are higher than those of boys by 10%. A gender gap has been apparent for over a <strong>15</strong> <input type="text" id="q15_input">. This situation is not unique to New Zealand, and has been noticed in <strong>16</strong> <input type="text" id="q16_input"> also.
                    </p>
                </div>
            </div>

            <div class="group" id="q17-20-anchor">
                 <h4>Questions 17–20</h4>
                <p>Reading Passage 2 has eight paragraphs, <strong>A–H</strong>.</p>
                <p>Which paragraph contains the following information?</p>
                <div style="overflow-x: auto;">
                    <table class="matching-table">
                        <thead>
                            <tr>
                                <th style="min-width: 200px;"></th>
                                <th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>17</strong> an advantage of New Zealand's secondary school tests</td>
                                <td><input type="radio" name="q17" value="A"></td><td><input type="radio" name="q17" value="B"></td><td><input type="radio" name="q17" value="C"></td><td><input type="radio" name="q17" value="D"></td><td><input type="radio" name="q17" value="E"></td><td><input type="radio" name="q17" value="F"></td><td><input type="radio" name="q17" value="G"></td><td><input type="radio" name="q17" value="H"></td>
                            </tr>
                            <tr>
                                <td><strong>18</strong> a mention of current government initiatives to boost male achievement</td>
                                <td><input type="radio" name="q18" value="A"></td><td><input type="radio" name="q18" value="B"></td><td><input type="radio" name="q18" value="C"></td><td><input type="radio" name="q18" value="D"></td><td><input type="radio" name="q18" value="E"></td><td><input type="radio" name="q18" value="F"></td><td><input type="radio" name="q18" value="G"></td><td><input type="radio" name="q18" value="H"></td>
                            </tr>
                            <tr>
                                <td><strong>19</strong> when gender difference in literacy skills first becomes evident</td>
                                <td><input type="radio" name="q19" value="A"></td><td><input type="radio" name="q19" value="B"></td><td><input type="radio" name="q19" value="C"></td><td><input type="radio" name="q19" value="D"></td><td><input type="radio" name="q19" value="E"></td><td><input type="radio" name="q19" value="F"></td><td><input type="radio" name="q19" value="G"></td><td><input type="radio" name="q19" value="H"></td>
                            </tr>
                            <tr>
                                <td><strong>20</strong> findings that relate academic achievement to race</td>
                                <td><input type="radio" name="q20" value="A"></td><td><input type="radio" name="q20" value="B"></td><td><input type="radio" name="q20" value="C"></td><td><input type="radio" name="q20" value="D"></td><td><input type="radio" name="q20" value="E"></td><td><input type="radio" name="q20" value="F"></td><td><input type="radio" name="q20" value="G"></td><td><input type="radio" name="q20" value="H"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="group" id="q21-26-anchor">
                <h4>Questions 21–26</h4>
                <p>Look at the following people (Questions 21–26) and the list of statements below.</p>
                <p>Match each person with the correct statement, <strong>A–H</strong>.</p>
                
                <div class="match-question-item">
                    <p><strong>21</strong> Celia Lashlie</p>
                    <div class="match-dropzone" data-question="q21"></div>
                </div>
                <div class="match-question-item">
                    <p><strong>22</strong> Steve Benson</p>
                    <div class="match-dropzone" data-question="q22"></div>
                </div>
                 <div class="match-question-item">
                     <p><strong>23</strong> Roger Moses</p>
                    <div class="match-dropzone" data-question="q23"></div>
                </div>
                 <div class="match-question-item">
                    <p><strong>24</strong> Rob Burroughs</p>
                    <div class="match-dropzone" data-question="q24"></div>
                </div>
                <div class="match-question-item">
                    <p><strong>25</strong> Stuart Martin</p>
                    <div class="match-dropzone" data-question="q25"></div>
                </div>
                <div class="match-question-item">
                    <p><strong>26</strong> Paul Baker</p>
                    <div class="match-dropzone" data-question="q26"></div>
                </div>

                <div class="options-pool" id="statements-options-pool">
                    <strong>List of Statements</strong>
                    <div class="pool-items">
                        <div class="drag-item" draggable="true" data-option="A">A Boys gain lower marks on NCEA if they attend an all-boys' school.</div>
                        <div class="drag-item" draggable="true" data-option="B">B Boys are disadvantaged by girls tending to take over at school.</div>
                        <div class="drag-item" draggable="true" data-option="C">C Good teaching is more important than whether classrooms are single-sex or mixed.</div>
                        <div class="drag-item" draggable="true" data-option="D">D Mathematical skills were not so important in the past.</div>
                        <div class="drag-item" draggable="true" data-option="E">E The difference in achievement between schoolboys and girls is only evident in some subjects.</div>
                        <div class="drag-item" draggable="true" data-option="F">F Older boys are more motivated to study than younger boys.</div>
                        <div class="drag-item" draggable="true" data-option="G">G The NCEA exams have higher literacy standards than past exams did.</div>
                        <div class="drag-item" draggable="true" data-option="H">H The New Zealand government is reluctant to take action on behalf of boys.</div>
                    </div>
                </div>
            </div>

            <div id="results"></div>
        </section>
    </div>

    <div class="practice-nav">
        <div class="title">Questions</div>
        <div class="questions">
            <div class="q-item" id="q14-nav" onclick="scrollToElement('q14-16-anchor')">14</div>
            <div class="q-item" id="q15-nav" onclick="scrollToElement('q14-16-anchor')">15</div>
            <div class="q-item" id="q16-nav" onclick="scrollToElement('q14-16-anchor')">16</div>
            <div class="q-item" id="q17-nav" onclick="scrollToElement('q17-20-anchor')">17</div>
            <div class="q-item" id="q18-nav" onclick="scrollToElement('q17-20-anchor')">18</div>
            <div class="q-item" id="q19-nav" onclick="scrollToElement('q17-20-anchor')">19</div>
            <div class="q-item" id="q20-nav" onclick="scrollToElement('q17-20-anchor')">20</div>
            <div class="q-item" id="q21-nav" onclick="scrollToElement('q21-26-anchor')">21</div>
            <div class="q-item" id="q22-nav" onclick="scrollToElement('q21-26-anchor')">22</div>
            <div class="q-item" id="q23-nav" onclick="scrollToElement('q21-26-anchor')">23</div>
            <div class="q-item" id="q24-nav" onclick="scrollToElement('q21-26-anchor')">24</div>
            <div class="q-item" id="q25-nav" onclick="scrollToElement('q21-26-anchor')">25</div>
            <div class="q-item" id="q26-nav" onclick="scrollToElement('q21-26-anchor')">26</div>
        </div>
        <div class="controls">
            <button id="submit-btn" class="primary">Submit</button>
            <button id="reset-btn">Reset</button>
            <button id="pause-btn">Pause</button>
        </div>
    </div>

    <div aria-label="Selection tools" id="selbar" role="toolbar">
        <button id="btnHL">Highlight</button>
        <button id="btnUH">Remove</button>
        <button id="btnNote">Note</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Global State ---
            let settingsOpen = false, notesOpen = false;
            let timerRunning = true, seconds = 0, timer;
            let isResizing = false;
            let selbar = document.getElementById('selbar');
            let lastRange = null, currentHlNode = null, keepToolbar = false;
            
            const correctAnswers = {
                q14: 'pass rates',
                q15: 'decade',
                q16: 'Australia',
                q17: 'C',
                q18: 'B',
                q19: 'D',
                q20: 'E',
                q21: 'H',
                q22: 'E',
                q23: 'G',
                q24: 'C',
                q25: 'F',
                q26: 'B'
            };

            // --- Core Functions ---
            function startTimer() {
                timer = setInterval(() => {
                    if (timerRunning) {
                        seconds++;
                        const minutes = String(Math.floor(seconds / 60)).padStart(2, '0');
                        const secs = String(seconds % 60).padStart(2, '0');
                        document.getElementById('timer').textContent = `${minutes}:${secs}`;
                    }
                }, 1000);
            }

            function closeAllPanels() {
                notesOpen = false; settingsOpen = false;
                document.getElementById('notes-panel').style.display = 'none';
                document.getElementById('settings-panel').style.display = 'none';
                document.querySelector('.overlay').style.display = 'none';
            }

            window.scrollToElement = function(id) {
                const element = document.getElementById(id);
                const pane = element.closest('.pane');
                if (element && pane) {
                    const top = element.offsetTop - 20;
                    pane.scrollTo({ top, behavior: 'smooth' });
                }
            }
            
            function setupDragAndDrop() {
                let draggedElement = null;
                const pool = document.querySelector('#statements-options-pool .pool-items');
                const dropTargets = document.querySelectorAll('.match-dropzone');
                const allDraggables = document.querySelectorAll('#statements-options-pool .drag-item');

                function addDragListeners(draggable) {
                     draggable.addEventListener('dragstart', (e) => {
                        draggedElement = draggable;
                        setTimeout(() => draggable.classList.add('dragging'), 0);
                    });
                    draggable.addEventListener('dragend', () => {
                        if (draggedElement) {
                            draggedElement.classList.remove('dragging');
                        }
                        draggedElement = null;
                    });
                }

                allDraggables.forEach(draggable => {
                    addDragListeners(draggable);
                });

                const handleDragOver = (e) => {
                    e.preventDefault();
                    e.currentTarget.classList.add('drag-over');
                };

                const handleDragLeave = (e) => {
                    e.currentTarget.classList.remove('drag-over');
                };

                const handleDropOnZone = (e) => {
                    e.preventDefault();
                    const dropzone = e.currentTarget;
                    dropzone.classList.remove('drag-over');
                    if (!draggedElement) return;

                    if (dropzone.children.length > 0) {
                        const existingItem = dropzone.querySelector('.drag-item');
                        if (existingItem !== draggedElement) {
                            pool.appendChild(existingItem);
                            addDragListeners(existingItem);
                        }
                    }

                    dropzone.appendChild(draggedElement);
                    updateAnsweredState();
                };
                
                const handleDropOnPool = (e) => {
                    e.preventDefault();
                    const poolContainer = e.currentTarget;
                    poolContainer.classList.remove('drag-over');
                    if (!draggedElement) return;
                    
                    pool.appendChild(draggedElement);
                    addDragListeners(draggedElement);
                    updateAnsweredState();
                };

                dropTargets.forEach(target => {
                    target.addEventListener('dragover', handleDragOver);
                    target.addEventListener('dragleave', handleDragLeave);
                    target.addEventListener('drop', handleDropOnZone);
                });
                
                const poolContainer = document.getElementById('statements-options-pool');
                poolContainer.addEventListener('dragover', handleDragOver);
                poolContainer.addEventListener('dragleave', handleDragLeave);
                poolContainer.addEventListener('drop', handleDropOnPool);
            }


            function updateAnsweredState() {
                const totalQuestions = 26;
                for (let i = 14; i <= totalQuestions; i++) {
                    const navItem = document.getElementById(`q${i}-nav`);
                    if (!navItem) continue;
                    if (navItem.classList.contains('correct') || navItem.classList.contains('incorrect')) continue;

                    let answered = false;
                    if (i <= 16) {
                        answered = document.getElementById(`q${i}_input`).value.trim() !== "";
                    } else if (i <= 20) {
                        answered = !!document.querySelector(`input[name="q${i}"]:checked`);
                    } else {
                        answered = document.querySelector(`.match-dropzone[data-question="q${i}"]`).hasChildNodes();
                    }
                    navItem.classList.toggle('answered', answered);
                }
            }

            function gradeAnswers() {
                timerRunning = false;
                document.getElementById('pause-btn').textContent = 'Continue';
                let correctCount = 0;
                const totalQuestions = 13;
                let resultsHTML = '<h4>Results</h4><table class="results-table"><thead><tr><th>Question</th><th>Your Answer</th><th>Correct Answer</th><th>Result</th></tr></thead><tbody>';

                for (let i = 14; i <= 26; i++) {
                    let userAnswer, isCorrect;
                    const correctAnswer = correctAnswers[`q${i}`];
                    const navItem = document.getElementById(`q${i}-nav`);

                    if (i <= 16) {
                        const input = document.getElementById(`q${i}_input`);
                        userAnswer = input.value.trim() || 'No Answer';
                        isCorrect = userAnswer.toLowerCase() === correctAnswer.toLowerCase();
                    } else if (i <= 20) {
                        const userAnswerEl = document.querySelector(`input[name="q${i}"]:checked`);
                        userAnswer = userAnswerEl ? userAnswerEl.value : 'No Answer';
                        isCorrect = userAnswer === correctAnswer;
                    } else {
                        const dropzone = document.querySelector(`.match-dropzone[data-question="q${i}"]`);
                        const droppedItem = dropzone.querySelector('.drag-item');
                        userAnswer = droppedItem ? droppedItem.dataset.option : 'No Answer';
                        isCorrect = userAnswer === correctAnswer;
                    }

                    if (isCorrect) correctCount++;
                    
                    navItem.classList.add(isCorrect ? 'correct' : 'incorrect');
                    let displayUserAnswer = userAnswer;
                    let displayCorrectAnswer = correctAnswer;

                    if (i > 20) {
                        const allDraggableItems = document.querySelectorAll('.drag-item');
                        let userItemText = 'No Answer';
                        let correctItemText = 'N/A';
                        
                        allDraggableItems.forEach(item => {
                            if (item.dataset.option === userAnswer) userItemText = item.textContent;
                            if (item.dataset.option === correctAnswer) correctItemText = item.textContent;
                        });
                        
                        displayUserAnswer = userItemText;
                        displayCorrectAnswer = correctItemText;
                    }

                    resultsHTML += `<tr><td>${i}</td><td>${displayUserAnswer}</td><td>${displayCorrectAnswer}</td><td class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '✓' : '✗'}</td></tr>`;
                }
                
                const score = Math.round((correctCount / totalQuestions) * 100);
                const summary = `<div style="font-weight:bold; margin-top:16px; font-size:1.1em;">Final Score: ${score}% (${correctCount}/${totalQuestions})</div>`;
                resultsHTML += `</tbody></table>`;
                
                document.getElementById('results').innerHTML = summary + resultsHTML;
                document.getElementById('results').style.display = 'block';
                scrollToElement('results');
            }

            function resetQuiz() {
                document.querySelectorAll('input[type="text"]').forEach(el => el.value = '');
                document.querySelectorAll('input[type="radio"]').forEach(el => el.checked = false);
                
                const pool = document.querySelector('#statements-options-pool .pool-items');
                const dropzones = document.querySelectorAll('.match-dropzone');
                
                dropzones.forEach(dz => {
                    const item = dz.querySelector('.drag-item');
                    if (item) {
                        pool.appendChild(item);
                    }
                });

                document.querySelectorAll('.q-item').forEach(item => item.className = 'q-item');
                const resultsDiv = document.getElementById('results');
                resultsDiv.style.display = 'none';
                resultsDiv.innerHTML = '';
                
                seconds = 0;
                if (timer) clearInterval(timer);
                startTimer();
                timerRunning = true;
                document.getElementById('pause-btn').textContent = 'Pause';
                updateAnsweredState();
            }

            // --- Highlighter & Selection Toolbar ---
            function positionSelbarForRect(rect) {
                selbar.style.display = 'flex';
                requestAnimationFrame(() => {
                    const top = window.scrollY + rect.top - selbar.offsetHeight - 8;
                    const left = window.scrollX + rect.left + rect.width / 2 - selbar.offsetWidth / 2;
                    selbar.style.top = `${(top > 0) ? top : (window.scrollY + rect.bottom + 8)}px`;
                    selbar.style.left = `${Math.max(8, left)}px`;
                });
            }

            function updateSelbar() {
                const sel = window.getSelection();
                if (!sel || sel.rangeCount === 0 || sel.isCollapsed) {
                    if (!keepToolbar && !currentHlNode) { selbar.style.display = 'none'; currentHlNode = null; }
                    return;
                }
                const range = sel.getRangeAt(0);
                let container = range.commonAncestorContainer;
                if (container.nodeType === Node.TEXT_NODE) container = container.parentElement;
                
                const isInAllowedPane = document.getElementById('left').contains(container) || document.getElementById('right').contains(container);
                const isHighlighted = container.classList?.contains('hl') || container.closest('.hl');
                if (!isInAllowedPane && !isHighlighted) { selbar.style.display = 'none'; return; }
                
                lastRange = range.cloneRange();
                currentHlNode = isHighlighted ? container.closest('.hl') : null;
                positionSelbarForRect(range.getBoundingClientRect());
            }

            function doHighlight() {
                if (currentHlNode || !lastRange || lastRange.collapsed) return;
                const sel = window.getSelection();
                try {
                    const span = document.createElement('span');
                    span.className = 'hl';
                    lastRange.surroundContents(span);
                } catch (e) { console.error("Highlighting failed:", e); }
                sel?.removeAllRanges();
                selbar.style.display = 'none';
            }

            function removeHighlight() {
                const sel = window.getSelection();
                let targetNode = currentHlNode;
                if (!targetNode && lastRange) {
                    const ancestor = lastRange.commonAncestorContainer;
                    targetNode = ancestor.nodeType === Node.TEXT_NODE ? ancestor.parentElement.closest('.hl') : ancestor.closest('.hl');
                }
                if (targetNode) {
                    const p = targetNode.parentNode;
                    while (targetNode.firstChild) p.insertBefore(targetNode.firstChild, targetNode);
                    if(p) p.removeChild(targetNode);
                    p?.normalize();
                }
                currentHlNode = null; sel?.removeAllRanges(); selbar.style.display = 'none';
            }

            // --- Event Listeners Setup ---
            startTimer();
            setupDragAndDrop();

            // Header controls
            document.getElementById('size-btn').addEventListener('click', (e) => { e.stopPropagation(); settingsOpen = !settingsOpen; document.getElementById('settings-panel').style.display = settingsOpen ? 'block' : 'none'; });
            document.getElementById('color-btn').addEventListener('click', (e) => { e.stopPropagation(); settingsOpen = !settingsOpen; document.getElementById('settings-panel').style.display = settingsOpen ? 'block' : 'none'; });
            document.getElementById('note-btn').addEventListener('click', () => { closeAllPanels(); notesOpen = true; document.getElementById('notes-panel').style.display = 'flex'; document.querySelector('.overlay').style.display = 'block'; });
            document.querySelectorAll('.settings-option[data-size]').forEach(btn => btn.addEventListener('click', function() { document.documentElement.className = `font-${this.dataset.size}`; document.querySelectorAll('.settings-option[data-size]').forEach(b => b.classList.remove('active')); this.classList.add('active'); }));
            document.querySelectorAll('.settings-option[data-mode]').forEach(btn => btn.addEventListener('click', function() { document.body.classList.toggle('dark-mode', this.dataset.mode === 'dark'); document.querySelectorAll('.settings-option[data-mode]').forEach(b => b.classList.remove('active')); this.classList.add('active'); }));
            document.getElementById('close-note').addEventListener('click', closeAllPanels);
            document.querySelector('.overlay').addEventListener('click', closeAllPanels);
            document.addEventListener('click', (e) => {
                const settingsPanel = document.getElementById('settings-panel');
                const headerControls = document.querySelector('.header-controls');
                if (!settingsPanel.contains(e.target) && !headerControls.contains(e.target)) { settingsPanel.style.display = 'none'; settingsOpen = false; }
            });

            // Bottom nav controls
            document.getElementById('submit-btn').addEventListener('click', gradeAnswers);
            document.getElementById('reset-btn').addEventListener('click', resetQuiz);
            document.getElementById('pause-btn').addEventListener('click', function() { timerRunning = !timerRunning; this.textContent = timerRunning ? 'Pause' : 'Continue'; });

            // Pane resizing
            const divider = document.getElementById('divider');
            const leftPane = document.getElementById('left');
            divider.addEventListener('mousedown', (e) => { isResizing = true; document.body.style.cursor = 'ew-resize'; e.preventDefault(); });
            document.addEventListener('mousemove', (e) => { if (!isResizing) return; const shellRect = document.querySelector('.shell').getBoundingClientRect(); let leftWidth = (e.clientX - shellRect.left) / shellRect.width * 100; leftPane.style.width = `${Math.max(20, Math.min(80, leftWidth))}%`; });
            document.addEventListener('mouseup', () => { if (isResizing) { isResizing = false; document.body.style.cursor = ''; } });
            
            // Update answered state on change/input
            document.getElementById('right').addEventListener('change', updateAnsweredState);
            document.getElementById('right').addEventListener('input', updateAnsweredState);

            // Selection toolbar events
            document.addEventListener('mouseup', () => setTimeout(updateSelbar, 10));
            document.addEventListener('selectionchange', () => setTimeout(updateSelbar, 10));
            document.addEventListener('mousedown', (e) => { keepToolbar = !!e.target.closest('#selbar, .hl'); }, true);
            document.addEventListener('click', (e) => {
                const target = e.target;
                if (target.classList.contains('hl')) {
                    currentHlNode = target; lastRange = null; positionSelbarForRect(target.getBoundingClientRect());
                    window.getSelection()?.removeAllRanges(); setTimeout(() => { keepToolbar = false; }, 0);
                } else if (!selbar.contains(e.target)) { selbar.style.display = 'none'; currentHlNode = null; }
            }, true);
            document.getElementById('btnHL').addEventListener('click', doHighlight);
            document.getElementById('btnUH').addEventListener('click', removeHighlight);
            document.getElementById('btnNote').addEventListener('click', function() {
                let text = (currentHlNode ? currentHlNode.textContent : (lastRange ? lastRange.cloneContents().textContent : '')).trim();
                if (text) {
                    const noteArea = document.querySelector('#notes-panel textarea');
                    noteArea.value += (noteArea.value ? '\n\n' : '') + '> ' + text;
                    closeAllPanels(); notesOpen = true; document.getElementById('notes-panel').style.display = 'flex';
                    document.querySelector('.overlay').style.display = 'block'; noteArea.scrollTop = noteArea.scrollHeight;
                }
                selbar.style.display = 'none';
            });
        });
    </script>
</body>
</html>