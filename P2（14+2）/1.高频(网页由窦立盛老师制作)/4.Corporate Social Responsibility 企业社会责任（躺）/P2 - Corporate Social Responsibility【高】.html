<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>P2 - Corporate Social Responsibility</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  :root { 
    --line:#e5e7eb; 
    --bg:#f6f7fb; 
    --panel:#fff; 
    --accent:#3b82f6; 
    --muted:#6b7280; 
    --shadow:0 6px 20px rgba(0,0,0,.12); 
  }
  * { box-sizing: border-box; }
  html,body { height:100%; }
  body { 
    margin:0; 
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; 
    background:var(--bg); 
    padding-bottom: 82px; 
  }
  
  /* 布局样式 */
  .shell { display:flex; height:100vh; width:100%; }
  .pane { background:var(--panel); overflow:auto; padding:20px; }
  #left { flex: 0 0 50%; min-width: 280px; }
  #right { flex: 1 1 auto; min-width: 320px; background:#fbfbff; border-left:1px solid var(--line); }
  #divider { flex: 0 0 8px; background: linear-gradient(90deg,#e5e7eb,#d1d5db); cursor: ew-resize; position:relative; z-index: 5; user-select:none; }
  
  /* 文本样式 */
  h2,h3,h4 { margin:0 0 10px; }
  #left p { margin: 0 0 12px; line-height: 1.6; word-break: normal; overflow-wrap: normal; hyphens: none; }
  
  /* 组件样式 */
  .group { background:#fff; border:1px solid var(--line); border-radius:10px; padding:12px; margin-bottom:14px; }
  input.blank { 
    border:none; 
    border-bottom:1px solid #9ca3af; 
    padding:2px 4px; 
    font-size:1em; 
    background:transparent; 
    min-width: 80px;
  }
  input.blank:focus { outline:none; border-bottom:2px solid var(--accent); }
  
  /* 按钮样式 */
  button { 
    padding:8px 12px; 
    border:1px solid var(--line); 
    background:#fff; 
    border-radius:6px; 
    cursor:pointer; 
    transition:all 0.2s; 
    font-size:14px; 
  }
  button:hover { background:#f8fafc; border-color:#cbd5e1; }
  button.primary { 
    background:var(--accent); 
    color:#fff; 
    border-color:var(--accent); 
  }
  button.primary:hover { background:#2563eb; }
  
    /* 计时器样式*/
  #timer { 
    background:#fff; 
    color:var(--muted); 
    border:1px solid var(--line); 
    border-radius:6px; 
    padding:6px 12px; 
    cursor:pointer; 
    font-family: 'Courier New', monospace; 
    transition:all 0.2s; 
    min-width: 70px;
    text-align: center;
    font-size: 18px;
    font-weight: bold;
  }
  #timer:hover { 
    background:#f1f5f9; 
    border-color:var(--accent); 
  }
  #timer.paused { 
    color: #ef4444; 
    border-color: #fecaca; 
    background: #fef2f2; 
  }

/* 选择工具栏*/
  #selbar { 
    position: fixed; 
    display:none; 
    z-index: 2000; 
    background:#111; 
    color:#fff; 
    border-radius: 8px; 
    padding: 6px; 
    box-shadow: var(--shadow); 
    font-size: 13px; 
    gap:6px; 
    align-items: center; 
  }
  #selbar button { 
    background: transparent; 
    color:#fff; 
    border: 1px solid rgba(255,255,255,.25); 
    padding: 4px 8px; 
    border-radius: 6px; 
    cursor:pointer; 
  }
  #selbar button:hover { border-color:#fff; }
  
  /* 笔记面板 */
  #notes { 
    position: fixed; 
    right: 12px; 
    bottom: 12px; 
    width: 320px; 
    height: 42vh; 
    background:#fff; 
    border:1px solid var(--line); 
    border-radius: 12px; 
    display:none; 
    flex-direction: column; 
    z-index:1500; 
    box-shadow: var(--shadow); 
  }
  #notes header { 
    display:flex; 
    align-items:center; 
    justify-content: space-between; 
    padding:8px 10px; 
    border-bottom:1px solid var(--line); 
  }
  #notes textarea { 
    flex:1; 
    border:0; 
    padding:10px; 
    resize:none; 
    font-size:14px; 
    line-height:1.5; 
  }
  
  /* Toast通知 */
  #toast { 
    position: fixed; 
    bottom: 20px; 
    left: 50%; 
    transform: translateX(-50%); 
    background: rgba(0,0,0,0.8); 
    color: #fff; 
    padding: 8px 16px; 
    border-radius: 4px; 
    display: none; 
    z-index: 3000; 
    font-size: 14px; 
  }
  
  /* 答题导航 */
  .practice-nav { 
    background:#fff; 
    padding:12px 20px; 
    display:flex; 
    align-items:center; 
    gap:16px; 
    box-shadow:0 2px 4px rgba(0,0,0,.05); 
    flex-wrap:wrap; 
    position:fixed; 
    left:0; 
    right:0; 
    bottom:0; 
    border-top:2px solid var(--line); 
    z-index:4000; 
  }
  .practice-nav .title { font-weight:600; color:var(--muted); }
  .practice-nav .questions { 
    display:flex; 
    gap:8px; 
    align-items:center; 
    flex-wrap:wrap; 
  }
  .practice-nav .q-item { 
    padding:6px 10px; 
    border:1px solid var(--line); 
    border-radius:6px; 
    background:#fff; 
    cursor:pointer; 
    font-size:14px; 
    transition:all 0.2s; 
    min-width:36px; 
    text-align:center; 
  }
  .practice-nav .q-item:hover { 
    background:#f1f5f9; 
    border-color:var(--accent); 
  }
  .practice-nav .q-item.answered { 
    background:#e0e7ff; 
    border-color:var(--accent); 
    color:var(--accent); 
    font-weight:500; 
  }
  .practice-nav .q-item.active { 
    background:var(--accent); 
    color:#fff; 
  }
  .practice-nav .controls { 
    display:flex; 
    gap:12px; 
    margin-left:auto; 
    align-items:center; 
  }
  
  /* 答题结果显示 */
  #results { 
    background:#fff; 
    border:1px solid var(--line); 
    border-radius:10px; 
    padding:12px; 
    margin:16px 0; 
    font-family: monospace; 
    white-space:pre-wrap; 
  }
  #results p { margin:0 0 8px; }
  .badge { 
    background:#e0e7ff; 
    color:var(--accent); 
    padding:2px 8px; 
    border-radius:999px; 
    font-size:12px; 
  }
  
  /* 答案框*/
  details.answerbox { 
    background:#fff; 
    border:1px solid var(--line); 
    border-radius:10px; 
    padding:12px; 
    margin-top:10px; 
  }
  details.answerbox summary { 
    cursor:pointer; 
    font-weight:600; 
    list-style:none; 
    display:flex; 
    align-items:center; 
    justify-content:space-between; 
  }
  details.answerbox summary::-webkit-details-marker { display:none; }
  #answerContent { margin-top:10px; }
  #answerContent ol { margin:0; padding-left:20px; }
  #answerContent li { margin:4px 0; }
  
  /* 高亮样式 */
  .hl {
    background: #fff3a3;
    box-shadow: inset 0 -2px 0 rgba(0, 0, 0, .05);
    cursor: pointer;
  }
  body.dark .hl { background-color: #5b21b6; color: #f5f3ff; }
  
  /* 滚动条样式*/
  ::-webkit-scrollbar { width: 8px; height: 8px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: #c5c5d2; border-radius: 4px; }
  ::-webkit-scrollbar-thumb:hover { background: #999; }
  body.dark ::-webkit-scrollbar-thumb { background: #4a5568; }
  body.dark ::-webkit-scrollbar-thumb:hover { background: #718096; }

  /* 黑暗模式样式 */
  body.dark {
    --bg: #1a1a1a;
    --panel: #2a2a2a;
    --line: #4a4a4a;
    --muted: #999;
    color: #e0e0e0;
    background: var(--bg);
  }

  body.dark .pane {
    background: var(--panel);
    color: #e0e0e0;
  }

  body.dark #right {
    background: #222;
  }

  body.dark button {
    background: #3a3a3a;
    color: #e0e0e0;
    border-color: #555;
  }

  body.dark button:hover {
    background: #4a4a4a;
    border-color: var(--accent);
  }

  body.dark button.primary {
    background: var(--accent);
    color: #fff;
    border-color: var(--accent);
  }

  body.dark input.blank {
    color: #e0e0e0;
    border-bottom-color: #666;
  }

  body.dark input.blank:focus {
    border-bottom-color: var(--accent);
  }

  body.dark .group {
    background: #2f2f2f;
    border-color: var(--line);
  }

  body.dark .practice-nav {
    background: #252525;
    border-top-color: #444;
  }

  body.dark .practice-nav .q-item {
    background: #3a3a3a;
    color: #ccc;
    border-color: #555;
  }

  body.dark .practice-nav .q-item:hover {
    background: #4a4a4a;
    border-color: var(--accent);
  }

  body.dark .practice-nav .q-item.answered {
    background: #3949ab;
    border-color: #5c6bc0;
    color: #e8eaf6;
  }

  body.dark .practice-nav .q-item.active {
    background: var(--accent);
    color: #fff;
    border-color: var(--accent);
  }

  body.dark #timer {
    background: #3a3a3a;
    color: #ccc;
    border-color: #555;
  }

  body.dark #timer:hover {
    background: #4a4a4a;
    border-color: var(--accent);
  }

  body.dark #notes {
    background: #2f2f2f;
    border-color: var(--line);
    color: #e0e0e0;
  }

  body.dark #selbar {
    background: #111;
    color: #fff;
  }

  body.dark details.answerbox {
    background: #2f2f2f;
    border-color: var(--line);
  }

  /* 主题切换按钮 */
  .theme-toggle { 
    cursor: pointer; 
    background: transparent; 
    border: 1px solid var(--line);
    border-radius: 8px;
    padding: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    font-size: 16px;
    transition: all 0.2s ease;
  }
  .theme-toggle:hover {
    background: var(--accent);
    color: #fff;
    border-color: var(--accent);
    transform: scale(1.05);
  }
  .theme-toggle:active {
    transform: scale(0.95);
  }

  body.dark .theme-toggle {
    background: #3a3a3a;
    color: #e0e0e0;
    border-color: #555;
  }

  body.dark .theme-toggle:hover {
    background: var(--accent);
    color: #fff;
    border-color: var(--accent);
  }
  
  table { border-collapse: collapse; width:100%; }
  th, td { border:1px solid var(--line); padding:6px; text-align:center; font-size:14px; }
  th:first-child, td:first-child { width:92px; }
</style>
</head>
<body>

<div class="practice-nav">
  <div class="title">Questions</div>
  <div class="questions">
    <div class="q-item" id="q14-nav" onclick="scrollToElement('q14-anchor')">14</div>
    <div class="q-item" id="q15-nav" onclick="scrollToElement('q15-anchor')">15</div>
    <div class="q-item" id="q16-nav" onclick="scrollToElement('q16-anchor')">16</div>
    <div class="q-item" id="q17-nav" onclick="scrollToElement('q17-anchor')">17</div>
    <div class="q-item" id="q18-nav" onclick="scrollToElement('q18-anchor')">18</div>
    <div class="q-item" id="q19-nav" onclick="scrollToElement('q19-anchor')">19</div>
    <div class="q-item" id="q20-nav" onclick="scrollToElement('q20-anchor')">20</div>
    <div class="q-item" id="q21-nav" onclick="scrollToElement('q21-anchor')">21</div>
    <div class="q-item" id="q22-nav" onclick="scrollToElement('q22-anchor')">22</div>
    <div class="q-item" id="q23-nav" onclick="scrollToElement('q23-anchor')">23</div>
    <div class="q-item" id="q24-nav" onclick="scrollToElement('q24-anchor')">24</div>
    <div class="q-item" id="q25-nav" onclick="scrollToElement('q25-anchor')">25</div>
    <div class="q-item" id="q26-nav" onclick="scrollToElement('q26-anchor')">26</div>
  </div>
  <div class="controls">
    <span id="timer" onclick="toggleTimer()">00:00</span>
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark mode">🌙</button>
  </div>
</div>

<div class="shell">
  <section class="pane" id="left">
    <h2>READING PASSAGE 2</h2>
    <p>You should spend about 20 minutes on Questions 14–26, which are based on Reading Passage 2 below.</p>
    <h3>Corporate Social Responsibility</h3>
    
    <h4>Paragraph A</h4>
    <p>According to the maxim of business theory, the primary purpose of a corporation is to maximise profits for its shareholders. Yet in recent years, a new idea has emerged, one that challenges this traditional model. Corporate Social Responsibility (CSR) is the concept that companies should not only pursue profits, but also promote the interests of society as a whole. This idea has gained momentum as companies have faced increasing pressure from consumers, employees, and governments to behave more responsibly.</p>
    
    <h4>Paragraph B</h4>
    <p>CSR can take many forms, from environmental protection to charitable giving to improving working conditions. Some companies have embraced CSR wholeheartedly, developing comprehensive programmes that touch on every aspect of their operations. Others have been more reluctant, viewing CSR as an unnecessary expense that detracts from their primary goal of making money. Still others have adopted a cynical approach, using CSR as a marketing tool without making meaningful changes to their practices.</p>
    
    <h4>Paragraph C</h4>
    <p>One of the most common forms of CSR is environmental responsibility. This can include reducing carbon emissions, minimising waste, using renewable energy sources, and developing sustainable products. Companies that pursue environmental CSR often find that it not only benefits the planet, but also saves them money in the long run through improved efficiency and reduced resource consumption. Moreover, environmentally conscious companies often enjoy a positive reputation among consumers, which can translate into increased sales.</p>
    
    <h4>Paragraph D</h4>
    <p>Another important aspect of CSR is social responsibility, which encompasses a wide range of activities aimed at improving society. This might include supporting local communities through charitable donations, volunteering, or partnerships with non-profit organisations. It can also involve ensuring fair labour practices throughout the company's supply chain, including safe working conditions, fair wages, and the prohibition of child labour. Some companies have also focused on diversity and inclusion initiatives, working to create more equitable workplaces.</p>
    
    <h4>Paragraph E</h4>
    <p>Economic responsibility is the third pillar of CSR. This involves conducting business in an ethical manner, including honest marketing practices, fair pricing, and transparent financial reporting. It also encompasses responsible investment practices and efforts to promote economic development in the communities where the company operates. Some companies have adopted the concept of creating shared value, which involves finding ways to generate profits while simultaneously addressing social problems.</p>
    
    <h4>Paragraph F</h4>
    <p>Critics of CSR argue that it represents a dangerous departure from the fundamental purpose of business. They contend that companies have a fiduciary duty to maximise shareholder value, and that diverting resources to social causes is a breach of that duty. These critics also argue that CSR can be used as a smokescreen to distract from unethical business practices, and that the most effective way for companies to benefit society is simply to focus on making profits and creating jobs.</p>
    
    <h4>Paragraph G</h4>
    <p>Proponents of CSR, on the other hand, argue that it is not only morally right but also economically beneficial. They point to studies showing that companies with strong CSR programmes often outperform their peers financially, suggesting that doing good and doing well are not mutually exclusive. They also argue that CSR helps companies attract and retain talented employees, build stronger relationships with customers, and mitigate risks associated with regulatory changes and social unrest.</p>
    
    <h4>Paragraph H</h4>
    <p>Despite the ongoing debate, CSR appears to be here to stay. A growing number of companies are incorporating social and environmental considerations into their core business strategies, and investors are increasingly taking CSR performance into account when making investment decisions. Governments around the world are also getting involved, implementing regulations that require companies to report on their social and environmental impact. As CSR continues to evolve, it will likely become an even more integral part of how businesses operate.</p>
    
  </section>
  <div id="divider" title="Drag to resize"></div>
  <section class="pane" id="right">
    <h3>Questions</h3>
    
    <div class="group">
      <h4>Questions 14–18</h4>
      <p>Reading Passage 2 has eight paragraphs, A–H.</p>
      <p>Which paragraph contains the following information?</p>
      <p>Write the correct letter, A–H, in boxes 14–18 on your answer sheet.</p>
      
      <div id="q14-anchor">
        <p><span class="q-item">14</span> &nbsp;&nbsp;&nbsp; A description of how CSR can help a company's financial performance<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q14" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q14" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q14" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q14" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q14" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q14" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q14" value="G"> G &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q14" value="H"> H</p>
      </div>
      
      <div id="q15-anchor">
        <p><span class="q-item">15</span> &nbsp;&nbsp;&nbsp; Examples of the different ways in which companies can engage in CSR<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q15" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q15" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q15" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q15" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q15" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q15" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q15" value="G"> G &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q15" value="H"> H</p>
      </div>
      
      <div id="q16-anchor">
        <p><span class="q-item">16</span> &nbsp;&nbsp;&nbsp; A reference to the traditional view of what a company's main purpose should be<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q16" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q16" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q16" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q16" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q16" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q16" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q16" value="G"> G &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q16" value="H"> H</p>
      </div>
      
      <div id="q17-anchor">
        <p><span class="q-item">17</span> &nbsp;&nbsp;&nbsp; Examples of economic responsibilities<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q17" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q17" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q17" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q17" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q17" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q17" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q17" value="G"> G &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q17" value="H"> H</p>
      </div>
      
      <div id="q18-anchor">
        <p><span class="q-item">18</span> &nbsp;&nbsp;&nbsp; A reference to the idea that CSR can be used for marketing purposes<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q18" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q18" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q18" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q18" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q18" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q18" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q18" value="G"> G &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q18" value="H"> H</p>
      </div>
    </div>
    
    <div class="group">
      <h4>Questions 19–23</h4>
      <p>Do the following statements agree with the information given in Reading Passage 2?</p>
      <p>In boxes 19–23 on your answer sheet, write</p>
      <p><strong>TRUE</strong> &nbsp;&nbsp;&nbsp; if the statement agrees with the information<br>
      <strong>FALSE</strong> &nbsp;&nbsp;&nbsp; if the statement contradicts the information<br>
      <strong>NOT GIVEN</strong> &nbsp;&nbsp;&nbsp; if there is no information on this</p>
      
      <div id="q19-anchor">
        <p><span class="q-item">19</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q19" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q19" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q19" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Some companies have found that environmental responsibility can reduce their costs.</p>
      </div>
      
      <div id="q20-anchor">
        <p><span class="q-item">20</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q20" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q20" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q20" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Social responsibility activities are limited to charitable donations.</p>
      </div>
      
      <div id="q21-anchor">
        <p><span class="q-item">21</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q21" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q21" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q21" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Critics of CSR believe that companies should prioritise social benefits over profits.</p>
      </div>
      
      <div id="q22-anchor">
        <p><span class="q-item">22</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q22" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q22" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q22" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Companies with strong CSR programmes often perform better financially than those without them.</p>
      </div>
      
      <div id="q23-anchor">
        <p><span class="q-item">23</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q23" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q23" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q23" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; All governments are beginning to implement CSR regulations.</p>
      </div>
    </div>
    
    <div class="group">
      <h4>Questions 24–26</h4>
      <p>Complete the sentences below.</p>
      <p>Choose <strong>NO MORE THAN TWO WORDS</strong> from the passage for each answer.</p>
      <p>Write your answers in boxes 24–26 on your answer sheet.</p>
      
      <div id="q24-anchor">
        <p><span class="q-item">24</span> &nbsp;&nbsp;&nbsp; CSR is the concept that companies should not only pursue profits, but also promote the interests of <input type="text" name="q24" class="blank">.</p>
      </div>
      
      <div id="q25-anchor">
        <p><span class="q-item">25</span> &nbsp;&nbsp;&nbsp; Companies that are environmentally conscious often enjoy a positive <input type="text" name="q25" class="blank"> among consumers.</p>
      </div>
      
      <div id="q26-anchor">
        <p><span class="q-item">26</span> &nbsp;&nbsp;&nbsp; Some companies have adopted the concept of creating <input type="text" name="q26" class="blank">, which involves finding ways to generate profits while simultaneously addressing social problems.</p>
      </div>
    </div>
    
    <div style="display:flex;gap:8px;margin-bottom:10px;">
      <button class="primary" onclick="grade()">Submit</button>
      <button onclick="resetForm()">Reset</button>
      <button onclick="toggleNotes()">Notes</button>
    </div>
    <div id="results"></div>
    <details class="answerbox" id="answerBox">
      <summary>Show answers (click to toggle) <span class="badge">hidden</span></summary>
      <div id="answerContent"></div>
    </details>
  </section>
</div>

<div aria-label="Selection tools" id="selbar" role="toolbar">
  <button id="btnHL">Highlight</button>
  <button id="btnUH">Remove</button>
  <button id="btnNote">Note</button>
</div>

<div id="notes">
  <header>
    <strong>Notes</strong>
    <div>
      <button id="btnCopy">Copy</button>
      <button id="btnClose">Close</button>
    </div>
  </header>
  <textarea id="noteArea" placeholder="Type your notes here..."></textarea>
</div>

<div id="toast"></div>

<script>
// 页面滚动功能
function scrollToElement(id) {
  const element = document.getElementById(id);
  if (element) {
    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
    // 高亮显示题目
    element.style.backgroundColor = '#e0e7ff';
    setTimeout(() => {
      element.style.backgroundColor = '';
    }, 1000);
  }
}

// 重置表单功能
function resetForm() {
  // 重置单选按钮
  document.querySelectorAll('input[type="radio"]').forEach(radio => {
    radio.checked = false;
  });
  
  // 重置文本输入框
  document.querySelectorAll('input.blank').forEach(input => {
    input.value = '';
  });
  
  // 清除结果
  document.getElementById('results').innerHTML = '';
  
  // 更新导航状态
  updateAnswerStatus();
  
  showToast('Form reset');
}

// Toast通知功能
function showToast(msg) {
  const toastEl = document.getElementById('toast');
  toastEl.textContent = msg;
  toastEl.style.display = 'block';
  setTimeout(() => {
    toastEl.style.display = 'none';
  }, 1500);
}

// 计时器功能
let _t = 0;
let timerRunning = true;
let timerInterval;
const _timerEl = document.getElementById('timer');

function updateTimer() {
  const m = Math.floor(_t / 60);
  const s = _t % 60;
  _timerEl.textContent = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
}

function startTimer() {
  timerInterval = setInterval(() => {
    if (timerRunning) {
      _t++;
      updateTimer();
    }
  }, 1000);
}

function toggleTimer() {
  if (timerRunning) {
    clearInterval(timerInterval);
    timerRunning = false;
    _timerEl.classList.add('paused');
    showToast('Timer paused');
  } else {
    startTimer();
    timerRunning = true;
    _timerEl.classList.remove('paused');
    showToast('Timer resumed');
  }
}

// 主题切换功能
function toggleTheme() {
  document.body.classList.toggle('dark');
  const isDark = document.body.classList.contains('dark');
  localStorage.setItem('darkMode', isDark);
  const themeButton = document.querySelector('.theme-toggle');
  themeButton.textContent = isDark ? '☀️' : '🌙';
}

// 拖拽分栏功能
var divider = document.getElementById('divider');
var left = document.getElementById('left');
var right = document.getElementById('right');
var dragging = false;

function startDrag(e) {
  dragging = true;
  document.body.style.cursor = 'ew-resize';
  if (e.preventDefault) e.preventDefault();
}

function endDrag() {
  dragging = false;
  document.body.style.cursor = '';
}

function onMove(clientX) {
  var container = document.querySelector('.shell').getBoundingClientRect();
  var x = clientX - container.left;
  x = Math.max(280, Math.min(container.width - 320, x));
  left.style.flex = '0 0 ' + x + 'px';
  right.style.flex = '1 1 auto';
}

divider.addEventListener('mousedown', function(e) { startDrag(e); });
window.addEventListener('mousemove', function(e) { if (dragging) onMove(e.clientX); });
window.addEventListener('mouseup', endDrag);
divider.addEventListener('touchstart', function(e) { startDrag(e.touches[0]); }, { passive: false });
window.addEventListener('touchmove', function(e) { if (dragging) onMove(e.touches[0].clientX); }, { passive: false });
window.addEventListener('touchend', endDrag);

// 高亮和笔记功能
var selbar = document.getElementById('selbar');
var btnHL = document.getElementById('btnHL');
var btnUH = document.getElementById('btnUH');
var btnNote = document.getElementById('btnNote');
var lastRange = null;
var currentHlNode = null;
var keepToolbar = false;

function positionSelbarForRect(rect) {
  selbar.style.display = 'flex';
  requestAnimationFrame(function() {
    var top = window.scrollY + rect.top - selbar.offsetHeight - 8;
    var leftPos = window.scrollX + rect.left + rect.width/2 - selbar.offsetWidth/2;
    selbar.style.top = ((top > 0) ? top : (window.scrollY + rect.bottom + 8)) + 'px';
    selbar.style.left = Math.max(8, leftPos) + 'px';
  });
}

function updateSelbar() {
  var sel = window.getSelection();
  if (!sel || sel.rangeCount === 0 || sel.isCollapsed) {
    selbar.style.display = 'none';
    currentHlNode = null;
    return;
  }
  var range = sel.getRangeAt(0);
  lastRange = range.cloneRange();
  currentHlNode = null;
  positionSelbarForRect(range.getBoundingClientRect());
}

document.getElementById('left').addEventListener('mouseup', updateSelbar);
document.getElementById('right').addEventListener('mouseup', updateSelbar);
document.addEventListener('selectionchange', function() {
  var sel = window.getSelection();
  if (!sel || sel.rangeCount === 0 || sel.isCollapsed) {
    if (!keepToolbar && !currentHlNode) {
      selbar.style.display = 'none';
    }
  }
});
document.addEventListener('scroll', function() {
  if (selbar.style.display === 'flex') updateSelbar();
});

document.addEventListener('mousedown', function(e) {
  var t = e.target;
  if (t.classList && t.classList.contains('hl')) {
    keepToolbar = true;
  } else {
    keepToolbar = false;
  }
}, true);

document.addEventListener('click', function(e) {
  var target = e.target;
  if (target.classList && target.classList.contains('hl')) {
    currentHlNode = target;
    lastRange = null;
    positionSelbarForRect(target.getBoundingClientRect());
    var sel = window.getSelection();
    if (sel) sel.removeAllRanges();
    setTimeout(function() { keepToolbar = false; }, 0);
  }
}, true);

function doHighlight() {
  if (currentHlNode) return;
  if (!lastRange || lastRange.collapsed) return;
  
  const startNode = lastRange.startContainer;
  const endNode = lastRange.endContainer;
  
  if (startNode === endNode) {
    try {
      const span = document.createElement('span');
      span.className = 'hl';
      lastRange.surroundContents(span);
      selbar.style.display = 'none';
      showToast('Highlighted');
      return;
    } catch (e) {}
  }
  
  const fragment = lastRange.cloneContents();
  const div = document.createElement('div');
  div.appendChild(fragment);
  
  function processNode(node) {
    if (node.nodeType === Node.TEXT_NODE) {
      if (node.textContent.trim().length > 0) {
        const span = document.createElement('span');
        span.className = 'hl';
        span.textContent = node.textContent;
        return span;
      }
      return node;
    }
    
    if (node.nodeType === Node.ELEMENT_NODE) {
      const isBlock = window.getComputedStyle(node).display.includes('block') ||
        ['P', 'H1', 'H2', 'H3', 'H4', 'DIV'].includes(node.tagName);
      
      const wrapper = isBlock ? document.createElement(node.tagName.toLowerCase()) : document.createElement('span');
      wrapper.className = isBlock ? node.className + ' hl' : 'hl';
      
      Array.from(node.attributes).forEach(attr => {
        wrapper.setAttribute(attr.name, attr.value);
      });
      
      while (node.firstChild) {
        const processedChild = processNode(node.firstChild);
        wrapper.appendChild(processedChild);
      }
      
      return wrapper;
    }
    
    return node;
  }
  
  const highlightedContent = processNode(div);
  lastRange.deleteContents();
  lastRange.insertNode(highlightedContent);
  
  selbar.style.display = 'none';
  showToast('Highlighted');
}

function removeHighlight() {
  if (currentHlNode) {
    const parent = currentHlNode.parentNode;
    while (currentHlNode.firstChild) {
      parent.insertBefore(currentHlNode.firstChild, currentHlNode);
    }
    parent.removeChild(currentHlNode);
    parent.normalize();
    currentHlNode = null;
    selbar.style.display = 'none';
    showToast('Highlight removed');
    return;
  }
  
  if (!lastRange) return;
  
  const selRect = lastRange.getBoundingClientRect();
  const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_ELEMENT);
  const toRemove = [];
  
  while (walker.nextNode()) {
    const node = walker.currentNode;
    if (node.classList && node.classList.contains('hl')) {
      const rect = node.getBoundingClientRect();
      if (!(rect.right < selRect.left || rect.left > selRect.right ||
        rect.bottom < selRect.top || rect.top > selRect.bottom)) {
        toRemove.push(node);
      }
    }
  }
  
  toRemove.forEach(el => {
    const parent = el.parentNode;
    while (el.firstChild) {
      parent.insertBefore(el.firstChild, el);
    }
    parent.removeChild(el);
    parent.normalize();
  });
  
  selbar.style.display = 'none';
  showToast('Highlight removed');
}

btnHL.addEventListener('click', doHighlight);
btnUH.addEventListener('click', removeHighlight);

// 笔记功能
var notes = document.getElementById('notes');
var noteArea = document.getElementById('noteArea');
var btnCopy = document.getElementById('btnCopy');
var btnClose = document.getElementById('btnClose');

function toggleNotes() {
  notes.style.display = (notes.style.display === 'flex' ? 'none' : 'flex');
}
window.toggleNotes = toggleNotes;

btnClose.addEventListener('click', toggleNotes);
btnCopy.addEventListener('click', async function() {
  await navigator.clipboard.writeText(noteArea.value || '');
  showToast('Copied');
});

btnNote.addEventListener('click', function() {
  var text = '';
  if (currentHlNode) {
    text = (currentHlNode.textContent || '').trim();
  } else if (lastRange) {
    var frag = lastRange.cloneContents();
    text = (frag.textContent || '').trim();
  }
  toggleNotes();
  if (text) {
    noteArea.value = (noteArea.value ? noteArea.value + '\n' : '') + '> ' + text + '\n';
  }
  selbar.style.display = 'none';
});

// 答题状态更新
function updateAnswerStatus() {
  for (let i = 14; i <= 26; i++) {
    const inputs = document.querySelectorAll(`input[name="q${i}"]`);
    const navItem = document.getElementById(`q${i}-nav`);
    if (navItem) {
      let answered = false;
      inputs.forEach(input => {
        if ((input.type === 'radio' || input.type === 'checkbox') && input.checked) {
          answered = true;
        } else if (input.type === 'text' && input.value.trim()) {
          answered = true;
        }
      });
      if (answered) {
        navItem.classList.add('answered');
      } else {
        navItem.classList.remove('answered');
      }
    }
  }
}

// 答案和评分系统
var answers = {
  "q14": "G", "q15": "B", "q16": "A", "q17": "E", "q18": "B",
  "q19": "TRUE", "q20": "FALSE", "q21": "FALSE", "q22": "TRUE", "q23": "NOT GIVEN",
  "q24": "society", "q25": "reputation", "q26": "shared value"
};

function grade() {
  var total = 0, correct = 0, lines = [];
  
  // 检查单选题 (14-23)
  for (let n = 14; n <= 23; n++) {
    const q = `q${n}`;
    total++;
    const selected = document.querySelector(`input[name="${q}"]:checked`);
    const userAnswer = selected ? selected.value : '';
    const isCorrect = userAnswer === answers[q];
    if (isCorrect) correct++;
    lines.push(`${q.toUpperCase()}: ${userAnswer || 'None'} ${isCorrect ? '✓' : '✗'}`);
  }
  
  // 检查文本输入题 (24-26)
  for (let n = 24; n <= 26; n++) {
    const q = `q${n}`;
    total++;
    const input = document.querySelector(`input[name="${q}"]`);
    const userAnswer = input ? input.value.trim().toLowerCase() : '';
    const correctAnswer = answers[q].toLowerCase();
    const isCorrect = userAnswer === correctAnswer;
    if (isCorrect) correct++;
    lines.push(`${q.toUpperCase()}: ${userAnswer || 'None'} ${isCorrect ? '✓' : '✗'}`);
  }
  
  // 显示结果
  const acc = Math.round(100 * correct / total);
  document.getElementById('results').innerHTML = `
    <p><strong>Score:</strong> ${correct}/${total} <span class="badge">Accuracy ${acc}%</span></p>
    <pre>${lines.join('\n')}</pre>
  `;
  
  // 显示答案
  document.getElementById('answerContent').innerHTML = `
    <ol>
      <li>14. G</li>
      <li>15. B</li>
      <li>16. A</li>
      <li>17. E</li>
      <li>18. B</li>
      <li>19. TRUE</li>
      <li>20. FALSE</li>
      <li>21. FALSE</li>
      <li>22. TRUE</li>
      <li>23. NOT GIVEN</li>
      <li>24. society</li>
      <li>25. reputation</li>
      <li>26. shared value</li>
    </ol>
  `;
  document.querySelector('#answerBox .badge').textContent = 'tap to view';
  
  updateAnswerStatus();
}

// 监听答案变化
document.addEventListener('change', updateAnswerStatus);
document.addEventListener('input', updateAnswerStatus);

// 页面加载完成后初始化
document.addEventListener('DOMContentLoaded', function() {
  startTimer();
  updateAnswerStatus(); // 初始化答题状态
  
  // 加载保存的主题
  if (localStorage.getItem('darkMode') === 'true') {
    document.body.classList.add('dark');
    document.querySelector('.theme-toggle').textContent = '☀️';
  }
});

// 练习页面增强脚本集成
function loadPracticePageEnhancer() {
  const script = document.createElement('script');
  script.src = '../../../js/practice-page-enhancer.js';
  script.onload = function() {
    console.log('练习页面增强脚本已加载');
      };
  script.onerror = function() {
    console.error('练习页面增强脚本加载失败');
    // 降级到内联增强
    loadInlineEnhancer();
  };
  document.head.appendChild(script);
}

// 内联增强器（降级方案）
function loadInlineEnhancer() {
  if (window.practicePageEnhancer) return;
  
  window.practicePageEnhancer = {
    initialize: function() {
      console.log('[InlineEnhancer] 内联增强器已初始化');
          this.setupCommunication();
      this.setupAnswerListeners();
      this.interceptSubmit();
    },
    
    setupCommunication: function() {
      this.parentWindow = window.opener || window.parent;
      window.addEventListener('message', (event) => {
        if (event.data && event.data.type === 'INIT_SESSION') {
          this.sessionId = event.data.data.sessionId;
          this.sendMessage('SESSION_READY', {
            pageType: this.detectPageType(),
            url: window.location.href
          });
        }
      });
    },
    
    detectPageType: function() {
      const title = document.title || '';
      if (title.includes('P1')) return 'P1';
      if (title.includes('P2')) return 'P2';
      if (title.includes('P3')) return 'P3';
      return 'unknown';
    },
    
    setupAnswerListeners: function() {
      this.answers = {};
      this.startTime = Date.now();
      
      document.addEventListener('change', (e) => {
        if (e.target.name && e.target.name.startsWith('q')) {
          this.answers[e.target.name] = e.target.value;
        }
      });
      
      document.addEventListener('input', (e) => {
        if (e.target.name && e.target.name.startsWith('q')) {
          this.answers[e.target.name] = e.target.value;
        }
      });
    },
    
    interceptSubmit: function() {
      // 拦截grade函数
      if (typeof window.grade === 'function') {
        const originalGrade = window.grade;
        window.grade = () => {
          const result = originalGrade();
          setTimeout(() => this.handleSubmit(), 200);
          return result;
        };
      }
      
      // 监听提交按钮
      document.addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON' &&
          (e.target.textContent.includes('Submit') ||
            e.target.onclick && e.target.onclick.toString().includes('grade'))) {
          setTimeout(() => this.handleSubmit(), 300);
        }
      });
    },
    
    handleSubmit: function() {
      const results = {
        sessionId: this.sessionId,
        startTime: this.startTime,
        endTime: Date.now(),
        duration: Math.round((Date.now() - this.startTime) / 1000),
        answers: this.answers,
        scoreInfo: this.extractScore(),
        pageType: this.detectPageType(),
        url: window.location.href
      };
      
      this.sendMessage('PRACTICE_COMPLETE', results);
    },
    
    extractScore: function() {
      const resultsEl = document.getElementById('results');
      if (!resultsEl) return null;
      
      const text = resultsEl.textContent || '';
      const scoreMatch = text.match(/Score:\s*(\d+)\/(\d+)/i);
      if (scoreMatch) {
        const correct = parseInt(scoreMatch[1]);
        const total = parseInt(scoreMatch[2]);
        return {
          correct: correct,
          total: total,
          accuracy: total > 0 ? correct / total : 0,
          percentage: Math.round((correct / total) * 100),
          source: 'inline_extraction'
        };
      }
      return null;
    },
    
    sendMessage: function(type, data) {
      if (this.parentWindow) {
        this.parentWindow.postMessage({
          type: type,
          data: data,
          source: 'practice_page'
        }, '*');
      }
    }
  };
  
  // 初始化
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      window.practicePageEnhancer.initialize();
    });
  } else {
    window.practicePageEnhancer.initialize();
  }
}

// 加载增强脚本
loadPracticePageEnhancer();
</script>

</body>
</html>
