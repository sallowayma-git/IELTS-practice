<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>P2 - Intelligent behaviour in birds</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  :root { 
    --line:#e5e7eb; 
    --bg:#f6f7fb; 
    --panel:#fff; 
    --accent:#3b82f6; 
    --muted:#6b7280; 
    --shadow:0 6px 20px rgba(0,0,0,.12); 
  }
  * { box-sizing: border-box; }
  html,body { height:100%; }
  body { 
    margin:0; 
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; 
    background:var(--bg); 
    padding-bottom: 82px; 
  }
  
  /* Â∏ÉÂ±ÄÊ†∑Âºè */
  .shell { display:flex; height:100vh; width:100%; }
  .pane { background:var(--panel); overflow:auto; padding:20px; }
  #left { flex: 0 0 50%; min-width: 280px; }
  #right { flex: 1 1 auto; min-width: 320px; background:#fbfbff; border-left:1px solid var(--line); }
  #divider { flex: 0 0 8px; background: linear-gradient(90deg,#e5e7eb,#d1d5db); cursor: ew-resize; position:relative; z-index: 5; user-select:none; }
  
  /* ÊñáÊú¨Ê†∑Âºè */
  h2,h3,h4 { margin:0 0 10px; }
  #left p { margin: 0 0 12px; line-height: 1.6; word-break: normal; overflow-wrap: normal; hyphens: none; }
  
  /* ÁªÑ‰ª∂Ê†∑Âºè */
  .group { background:#fff; border:1px solid var(--line); border-radius:10px; padding:12px; margin-bottom:14px; }
  input.blank { 
    border:none; 
    border-bottom:1px solid #9ca3af; 
    padding:2px 4px; 
    font-size:1em; 
    background:transparent; 
    min-width: 80px;
  }
  input.blank:focus { outline:none; border-bottom:2px solid var(--accent); }
  
  /* ÊåâÈíÆÊ†∑Âºè */
  button { 
    padding:8px 12px; 
    border:1px solid var(--line); 
    background:#fff; 
    border-radius:6px; 
    cursor:pointer; 
    transition:all 0.2s; 
    font-size:14px; 
  }
  button:hover { background:#f8fafc; border-color:#cbd5e1; }
  button.primary { 
    background:var(--accent); 
    color:#fff; 
    border-color:var(--accent); 
  }
  button.primary:hover { background:#2563eb; }
  
    /* ËÆ°Êó∂Âô®Ê†∑Âºè */
  #timer { 
    background:#fff; 
    color:var(--muted); 
    border:1px solid var(--line); 
    border-radius:6px; 
    padding:6px 12px; 
    cursor:pointer; 
    font-family: 'Courier New', monospace; 
    transition:all 0.2s; 
    min-width: 70px;
    text-align: center;
    font-size: 18px;
    font-weight: bold;
  }
  #timer:hover { 
    background:#f1f5f9; 
    border-color:var(--accent); 
  }
  #timer.paused { 
    color: #ef4444; 
    border-color: #fecaca; 
    background: #fef2f2; 
  }

/* ÈÄâÊã©Â∑•ÂÖ∑Ê†è */
  #selbar { 
    position: fixed; 
    display:none; 
    z-index: 2000; 
    background:#111; 
    color:#fff; 
    border-radius: 8px; 
    padding: 6px; 
    box-shadow: var(--shadow); 
    font-size: 13px; 
    gap:6px; 
    align-items: center; 
  }
  #selbar button { 
    background: transparent; 
    color:#fff; 
    border: 1px solid rgba(255,255,255,.25); 
    padding: 4px 8px; 
    border-radius: 6px; 
    cursor:pointer; 
  }
  #selbar button:hover { border-color:#fff; }
  
  /* Á¨îËÆ∞Èù¢Êùø */
  #notes { 
    position: fixed; 
    right: 12px; 
    bottom: 12px; 
    width: 320px; 
    height: 42vh; 
    background:#fff; 
    border:1px solid var(--line); 
    border-radius: 12px; 
    display:none; 
    flex-direction: column; 
    z-index:1500; 
    box-shadow: var(--shadow); 
  }
  #notes header { 
    display:flex; 
    align-items:center; 
    justify-content: space-between; 
    padding:8px 10px; 
    border-bottom:1px solid var(--line); 
  }
  #notes textarea { 
    flex:1; 
    border:0; 
    padding:10px; 
    resize:none; 
    font-size:14px; 
    line-height:1.5; 
  }
  
  /* ToastÈÄöÁü• */
  #toast { 
    position: fixed; 
    bottom: 20px; 
    left: 50%; 
    transform: translateX(-50%); 
    background: rgba(0,0,0,0.8); 
    color: #fff; 
    padding: 8px 16px; 
    border-radius: 4px; 
    display: none; 
    z-index: 3000; 
    font-size: 14px; 
  }
  
  /* Á≠îÈ¢òÂØºËà™ */
  .practice-nav { 
    background:#fff; 
    padding:12px 20px; 
    display:flex; 
    align-items:center; 
    gap:16px; 
    box-shadow:0 2px 4px rgba(0,0,0,.05); 
    flex-wrap:wrap; 
    position:fixed; 
    left:0; 
    right:0; 
    bottom:0; 
    border-top:2px solid var(--line); 
    z-index:4000; 
  }
  .practice-nav .title { font-weight:600; color:var(--muted); }
  .practice-nav .questions { 
    display:flex; 
    gap:8px; 
    align-items:center; 
    flex-wrap:wrap; 
  }
  .practice-nav .q-item { 
    padding:6px 10px; 
    border:1px solid var(--line); 
    border-radius:6px; 
    background:#fff; 
    cursor:pointer; 
    font-size:14px; 
    transition:all 0.2s; 
    min-width:36px; 
    text-align:center; 
  }
  .practice-nav .q-item:hover { 
    background:#f1f5f9; 
    border-color:var(--accent); 
  }
  .practice-nav .q-item.answered { 
    background:#e0e7ff; 
    border-color:var(--accent); 
    color:var(--accent); 
    font-weight:500; 
  }
  .practice-nav .q-item.active { 
    background:var(--accent); 
    color:#fff; 
  }
  .practice-nav .controls { 
    display:flex; 
    gap:12px; 
    margin-left:auto; 
    align-items:center; 
  }
  
  /* Á≠îÈ¢òÁªìÊûúÊòæÁ§∫ */
  #results { 
    background:#fff; 
    border:1px solid var(--line); 
    border-radius:10px; 
    padding:12px; 
    margin:16px 0; 
    font-family: monospace; 
    white-space:pre-wrap; 
  }
  #results p { margin:0 0 8px; }
  .badge { 
    background:#e0e7ff; 
    color:var(--accent); 
    padding:2px 8px; 
    border-radius:999px; 
    font-size:12px; 
  }
  
  /* Á≠îÊ°àÊ°Ü */
  details.answerbox { 
    background:#fff; 
    border:1px solid var(--line); 
    border-radius:10px; 
    padding:12px; 
    margin-top:10px; 
  }
  details.answerbox summary { 
    cursor:pointer; 
    font-weight:600; 
    list-style:none; 
    display:flex; 
    align-items:center; 
    justify-content:space-between; 
  }
  details.answerbox summary::-webkit-details-marker { display:none; }
  #answerContent { margin-top:10px; }
  #answerContent ol { margin:0; padding-left:20px; }
  #answerContent li { margin:4px 0; }
  
  /* È´ò‰∫ÆÊ†∑Âºè */
  .hl { background: #ffeb3b; color: #000; }
  body.dark .hl { background: #8a6d00; color: #fff; }
  
  /* ÊªöÂä®Êù°Ê†∑Âºè */
  ::-webkit-scrollbar { width: 8px; height: 8px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: #c5c5d2; border-radius: 4px; }
  ::-webkit-scrollbar-thumb:hover { background: #999; }
  body.dark ::-webkit-scrollbar-thumb { background: #4a5568; }
  body.dark ::-webkit-scrollbar-thumb:hover { background: #718096; }
  
  table { border-collapse: collapse; width:100%; }
  th, td { border:1px solid var(--line); padding:6px; text-align:center; font-size:14px; }
  th:first-child, td:first-child { width:92px; }
</style>
</head>
<body>

<div class="practice-nav">
  <div class="title">Questions</div>
  <div class="questions">
    <div class="q-item" id="q14-nav" onclick="scrollToElement('q14-anchor')">14</div>
    <div class="q-item" id="q15-nav" onclick="scrollToElement('q15-anchor')">15</div>
    <div class="q-item" id="q16-nav" onclick="scrollToElement('q16-anchor')">16</div>
    <div class="q-item" id="q17-nav" onclick="scrollToElement('q17-anchor')">17</div>
    <div class="q-item" id="q18-nav" onclick="scrollToElement('q18-anchor')">18</div>
    <div class="q-item" id="q19-nav" onclick="scrollToElement('q19-anchor')">19</div>
    <div class="q-item" id="q20-nav" onclick="scrollToElement('q20-anchor')">20</div>
    <div class="q-item" id="q21-nav" onclick="scrollToElement('q21-anchor')">21</div>
    <div class="q-item" id="q22-nav" onclick="scrollToElement('q22-anchor')">22</div>
    <div class="q-item" id="q23-nav" onclick="scrollToElement('q23-anchor')">23</div>
    <div class="q-item" id="q24-nav" onclick="scrollToElement('q24-anchor')">24</div>
    <div class="q-item" id="q25-nav" onclick="scrollToElement('q25-anchor')">25</div>
    <div class="q-item" id="q26-nav" onclick="scrollToElement('q26-anchor')">26</div>
  </div>
  <div class="controls">
    <span id="timer" onclick="toggleTimer()">00:00</span>
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark mode">üåô</button>
  </div>
</div>

<div class="shell">
  <section class="pane" id="left">
    <h2>READING PASSAGE 2</h2>
    <p>You should spend about 20 minutes on Questions 14‚Äì26, which are based on Reading Passage 2 below.</p>
    <h3>Intelligent behaviour in birds</h3>
    
    <h4>Paragraph A</h4>
    <p>For centuries, birds have captivated human observers with their remarkable abilities, from the complex songs of nightingales to the aerial acrobatics of swallows. However, it is only in recent decades that scientists have begun to seriously investigate the cognitive capabilities of birds. Traditional views held that birds possessed limited intelligence due to their relatively small brains and lack of a neocortex, the brain region associated with higher cognitive functions in mammals. This perspective has been dramatically overturned by research revealing sophisticated problem-solving abilities, tool use, and social intelligence in various bird species. Today, scientists recognize that avian intelligence is not merely a simplified version of mammalian intelligence but represents a unique evolutionary adaptation to environmental challenges.</p>
    
    <h4>Paragraph B</h4>
    <p>Corvids, including crows, ravens, and jays, have emerged as among the most intelligent creatures in the animal kingdom. These birds demonstrate remarkable problem-solving skills, often rivaling those of young children and great apes. In controlled experiments, New Caledonian crows have been observed crafting and modifying tools to extract food from difficult-to-reach places. They create hooks from twigs and leaves, selecting materials based on their flexibility and shape. What makes this behavior particularly impressive is that it appears to involve planning and foresight, with crows selecting and modifying tools before encountering a specific problem. This suggests a level of abstract thinking previously thought to be unique to humans and great apes.</p>
    
    <h4>Paragraph C</h4>
    <p>The social intelligence of birds extends far beyond simple communication. Many species demonstrate sophisticated understanding of social relationships and can navigate complex hierarchies. African grey parrots have shown the ability to learn and use human language meaningfully, not merely mimicking sounds but understanding concepts such as color, shape, and number. Alex, a famous African grey studied by Dr. Irene Pepperberg, could identify over 100 objects, recognize quantities up to six, and distinguish between materials such as wood, metal, and cloth. These abilities suggest that birds can process abstract concepts and use symbols to represent real-world objects, challenging traditional notions about the cognitive divide between humans and other animals.</p>
    
    <h4>Paragraph D</h4>
    <p>Memory plays a crucial role in avian intelligence, particularly for species that must remember the locations of thousands of food caches. Clark's nutcrackers, for example, can recall the precise locations of up to 30,000 cached seeds for months after hiding them. This extraordinary spatial memory involves the hippocampus, a brain region that is proportionally larger in food-caching birds than in non-caching species. The ability to remember complex spatial relationships is not limited to food caching; migratory birds must memorize vast geographical routes, often spanning continents, and can compensate for environmental changes by recalculating their paths. These memory feats demonstrate that birds possess sophisticated neural mechanisms for processing and storing spatial information.</p>
    
    <h4>Paragraph E</h4>
    <p>Birds also exhibit remarkable abilities in numerical cognition. Research has shown that some species can count, perform basic arithmetic, and understand concepts such as zero. Honeybees, though not birds, have provided a useful comparison for understanding numerical abilities in flying creatures. However, birds like the African grey parrot have demonstrated more advanced numerical skills, including the ability to understand the concept of zero as a numerical value rather than merely the absence of quantity. This understanding of zero represents a sophisticated mathematical concept that humans themselves did not fully grasp until relatively recently in our cultural development.</p>
    
    <h4>Paragraph F</h4>
    <p>The neural basis of avian intelligence has revealed surprising insights into brain evolution. Unlike mammals, birds do not possess a neocortex, yet they demonstrate cognitive abilities that rival or exceed those of many mammals. Research has shown that bird brains achieve this through a different organizational principle, with neurons packed more densely and forming different connection patterns. The pallium, the avian equivalent of the mammalian cortex, contains circuits that function similarly to those in mammalian brains despite their different structural organization. This convergent evolution of intelligence suggests that there are multiple pathways to cognitive sophistication, challenging the idea that mammalian brain architecture is the only route to advanced intelligence.</p>
    
    <h4>Paragraph G</h4>
    <p>The implications of avian intelligence research extend beyond understanding bird behavior. These findings have forced scientists to reconsider fundamental assumptions about the nature of intelligence itself. Rather than being a simple byproduct of brain size or mammalian brain architecture, intelligence appears to be a more flexible and diverse phenomenon. Birds have evolved cognitive solutions to environmental challenges that are often as effective as those developed by mammals, despite millions of years of separate evolution. This suggests that intelligence may be more widespread in the animal kingdom than previously believed and that different species may possess specialized forms of intelligence adapted to their particular ecological niches.</p>
    
  </section>
  <div id="divider" title="Drag to resize"></div>
  <section class="pane" id="right">
    <h3>Questions</h3>
    
    <div class="group">
      <h4>Questions 14‚Äì20</h4>
      <p>Reading Passage 2 has seven paragraphs, A‚ÄìG.</p>
      <p>Which paragraph contains the following information?</p>
      <p>Write the correct letter, A‚ÄìG, in boxes 14‚Äì20 on your answer sheet.</p>
      
      <div id="q14-anchor">
        <p><span class="q-item">14</span> &nbsp;&nbsp;&nbsp; A reference to the neural basis of avian intelligence<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q14" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q14" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q14" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q14" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q14" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q14" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q14" value="G"> G</p>
      </div>
      
      <div id="q15-anchor">
        <p><span class="q-item">15</span> &nbsp;&nbsp;&nbsp; A reference to numerical cognition in birds<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q15" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q15" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q15" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q15" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q15" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q15" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q15" value="G"> G</p>
      </div>
      
      <div id="q16-anchor">
        <p><span class="q-item">16</span> &nbsp;&nbsp;&nbsp; A reference to the social intelligence of birds<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q16" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q16" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q16" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q16" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q16" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q16" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q16" value="G"> G</p>
      </div>
      
      <div id="q17-anchor">
        <p><span class="q-item">17</span> &nbsp;&nbsp;&nbsp; A reference to memory in birds<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q17" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q17" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q17" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q17" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q17" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q17" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q17" value="G"> G</p>
      </div>
      
      <div id="q18-anchor">
        <p><span class="q-item">18</span> &nbsp;&nbsp;&nbsp; A reference to problem-solving skills in corvids<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q18" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q18" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q18" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q18" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q18" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q18" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q18" value="G"> G</p>
      </div>
      
      <div id="q19-anchor">
        <p><span class="q-item">19</span> &nbsp;&nbsp;&nbsp; A reference to traditional views of bird intelligence<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q19" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q19" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q19" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q19" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q19" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q19" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q19" value="G"> G</p>
      </div>
      
      <div id="q20-anchor">
        <p><span class="q-item">20</span> &nbsp;&nbsp;&nbsp; A reference to the implications of avian intelligence research<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="radio" name="q20" value="A"> A &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q20" value="B"> B &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q20" value="C"> C &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q20" value="D"> D &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q20" value="E"> E &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q20" value="F"> F &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q20" value="G"> G</p>
      </div>
    </div>
    
    <div class="group">
      <h4>Questions 21‚Äì26</h4>
      <p>Do the following statements agree with the information given in Reading Passage 2?</p>
      <p>In boxes 21‚Äì26 on your answer sheet, write</p>
      <p><strong>TRUE</strong> &nbsp;&nbsp;&nbsp; if the statement agrees with the information<br>
      <strong>FALSE</strong> &nbsp;&nbsp;&nbsp; if the statement contradicts the information<br>
      <strong>NOT GIVEN</strong> &nbsp;&nbsp;&nbsp; if there is no information on this</p>
      
      <div id="q21-anchor">
        <p><span class="q-item">21</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q21" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q21" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q21" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; New Caledonian crows create hooks from twigs and leaves.</p>
      </div>
      
      <div id="q22-anchor">
        <p><span class="q-item">22</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q22" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q22" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q22" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; African grey parrots can learn and use human language meaningfully.</p>
      </div>
      
      <div id="q23-anchor">
        <p><span class="q-item">23</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q23" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q23" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q23" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Clark's nutcrackers can recall the precise locations of up to 30,000 cached seeds.</p>
      </div>
      
      <div id="q24-anchor">
        <p><span class="q-item">24</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q24" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q24" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q24" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Birds possess a neocortex, the brain region associated with higher cognitive functions.</p>
      </div>
      
      <div id="q25-anchor">
        <p><span class="q-item">25</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q25" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q25" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q25" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Birds have evolved cognitive solutions to environmental challenges that are often as effective as those developed by mammals.</p>
      </div>
      
      <div id="q26-anchor">
        <p><span class="q-item">26</span> &nbsp;&nbsp;&nbsp; <input type="radio" name="q26" value="TRUE"> TRUE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q26" value="FALSE"> FALSE &nbsp;&nbsp;&nbsp; 
        <input type="radio" name="q26" value="NOT GIVEN"> NOT GIVEN<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alex, an African grey parrot, could identify over 100 objects.</p>
      </div>
    </div>
    
    <div style="display:flex;gap:8px;margin-bottom:10px;">
      <button class="primary" onclick="grade()">Submit</button>
      <button onclick="resetForm()">Reset</button>
      <button onclick="toggleNotes()">Notes</button>
    </div>
    <div id="results"></div>
    <details class="answerbox" id="answerBox">
      <summary>Show answers (click to toggle) <span class="badge">hidden</span></summary>
      <div id="answerContent"></div>
    </details>
  </section>
</div>

<div aria-label="Selection tools" id="selbar" role="toolbar">
  <button id="btnHL">Highlight</button>
  <button id="btnUH">Remove</button>
  <button id="btnNote">Note</button>
</div>

<div id="notes">
  <header>
    <strong>Notes</strong>
    <div>
      <button id="btnCopy">Copy</button>
      <button id="btnClose">Close</button>
    </div>
  </header>
  <textarea id="noteArea" placeholder="Type your notes here..."></textarea>
</div>

<div id="toast"></div>

<script>
// È°µÈù¢ÊªöÂä®ÂäüËÉΩ
function scrollToElement(id) {
  const element = document.getElementById(id);
  if (element) {
    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
    // È´ò‰∫ÆÊòæÁ§∫È¢òÁõÆ
    element.style.backgroundColor = '#e0e7ff';
    setTimeout(() => {
      element.style.backgroundColor = '';
    }, 1000);
  }
}

// ÈáçÁΩÆË°®ÂçïÂäüËÉΩ
function resetForm() {
  // ÈáçÁΩÆÂçïÈÄâÊåâÈíÆ
  document.querySelectorAll('input[type="radio"]').forEach(radio => {
    radio.checked = false;
  });
  
  // ÈáçÁΩÆÊñáÊú¨ËæìÂÖ•Ê°Ü
  document.querySelectorAll('input.blank').forEach(input => {
    input.value = '';
  });
  
  // Ê∏ÖÈô§ÁªìÊûú
  document.getElementById('results').innerHTML = '';
  
  // Êõ¥Êñ∞ÂØºËà™Áä∂ÊÄÅ
  updateAnswerStatus();
  
  showToast('Form reset');
}

// ToastÈÄöÁü•ÂäüËÉΩ
function showToast(msg) {
  const toastEl = document.getElementById('toast');
  toastEl.textContent = msg;
  toastEl.style.display = 'block';
  setTimeout(() => {
    toastEl.style.display = 'none';
  }, 1500);
}

// ËÆ°Êó∂Âô®ÂäüËÉΩ
let _t = 0;
let timerRunning = true;
let timerInterval;
const _timerEl = document.getElementById('timer');

function updateTimer() {
  const m = Math.floor(_t / 60);
  const s = _t % 60;
  _timerEl.textContent = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
}

function startTimer() {
  timerInterval = setInterval(() => {
    if (timerRunning) {
      _t++;
      updateTimer();
    }
  }, 1000);
}

function toggleTimer() {
  if (timerRunning) {
    clearInterval(timerInterval);
    timerRunning = false;
    _timerEl.classList.add('paused');
    showToast('Timer paused');
  } else {
    startTimer();
    timerRunning = true;
    _timerEl.classList.remove('paused');
    showToast('Timer resumed');
  }
}

// ‰∏ªÈ¢òÂàáÊç¢ÂäüËÉΩ
function toggleTheme() {
  document.body.classList.toggle('dark');
  const isDark = document.body.classList.contains('dark');
  localStorage.setItem('darkMode', isDark);
  const themeButton = document.querySelector('.theme-toggle');
  themeButton.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
}

// ÊãñÊãΩÂàÜÊ†èÂäüËÉΩ
var divider = document.getElementById('divider');
var left = document.getElementById('left');
var right = document.getElementById('right');
var dragging = false;

function startDrag(e) {
  dragging = true;
  document.body.style.cursor = 'ew-resize';
  if (e.preventDefault) e.preventDefault();
}

function endDrag() {
  dragging = false;
  document.body.style.cursor = '';
}

function onMove(clientX) {
  var container = document.querySelector('.shell').getBoundingClientRect();
  var x = clientX - container.left;
  x = Math.max(280, Math.min(container.width - 320, x));
  left.style.flex = '0 0 ' + x + 'px';
  right.style.flex = '1 1 auto';
}

divider.addEventListener('mousedown', function(e) { startDrag(e); });
window.addEventListener('mousemove', function(e) { if (dragging) onMove(e.clientX); });
window.addEventListener('mouseup', endDrag);
divider.addEventListener('touchstart', function(e) { startDrag(e.touches[0]); }, { passive: false });
window.addEventListener('touchmove', function(e) { if (dragging) onMove(e.touches[0].clientX); }, { passive: false });
window.addEventListener('touchend', endDrag);

// È´ò‰∫ÆÂíåÁ¨îËÆ∞ÂäüËÉΩ
var selbar = document.getElementById('selbar');
var btnHL = document.getElementById('btnHL');
var btnUH = document.getElementById('btnUH');
var btnNote = document.getElementById('btnNote');
var lastRange = null;
var currentHlNode = null;
var keepToolbar = false;

function positionSelbarForRect(rect) {
  selbar.style.display = 'flex';
  requestAnimationFrame(function() {
    var top = window.scrollY + rect.top - selbar.offsetHeight - 8;
    var leftPos = window.scrollX + rect.left + rect.width/2 - selbar.offsetWidth/2;
    selbar.style.top = ((top > 0) ? top : (window.scrollY + rect.bottom + 8)) + 'px';
    selbar.style.left = Math.max(8, leftPos) + 'px';
  });
}

function updateSelbar() {
  var sel = window.getSelection();
  if (!sel || sel.rangeCount === 0 || sel.isCollapsed) {
    selbar.style.display = 'none';
    currentHlNode = null;
    return;
  }
  var range = sel.getRangeAt(0);
  lastRange = range.cloneRange();
  currentHlNode = null;
  positionSelbarForRect(range.getBoundingClientRect());
}

document.getElementById('left').addEventListener('mouseup', updateSelbar);
document.getElementById('right').addEventListener('mouseup', updateSelbar);
document.addEventListener('selectionchange', function() {
  var sel = window.getSelection();
  if (!sel || sel.rangeCount === 0 || sel.isCollapsed) {
    if (!keepToolbar && !currentHlNode) {
      selbar.style.display = 'none';
    }
  }
});
document.addEventListener('scroll', function() {
  if (selbar.style.display === 'flex') updateSelbar();
});

document.addEventListener('mousedown', function(e) {
  var t = e.target;
  if (t.classList && t.classList.contains('hl')) {
    keepToolbar = true;
  } else {
    keepToolbar = false;
  }
}, true);

document.addEventListener('click', function(e) {
  var target = e.target;
  if (target.classList && target.classList.contains('hl')) {
    currentHlNode = target;
    lastRange = null;
    positionSelbarForRect(target.getBoundingClientRect());
    var sel = window.getSelection();
    if (sel) sel.removeAllRanges();
    setTimeout(function() { keepToolbar = false; }, 0);
  }
}, true);

function doHighlight() {
  if (currentHlNode) return;
  if (!lastRange || lastRange.collapsed) return;
  
  const startNode = lastRange.startContainer;
  const endNode = lastRange.endContainer;
  
  if (startNode === endNode) {
    try {
      const span = document.createElement('span');
      span.className = 'hl';
      lastRange.surroundContents(span);
      selbar.style.display = 'none';
      showToast('Highlighted');
      return;
    } catch (e) {}
  }
  
  const fragment = lastRange.cloneContents();
  const div = document.createElement('div');
  div.appendChild(fragment);
  
  function processNode(node) {
    if (node.nodeType === Node.TEXT_NODE) {
      if (node.textContent.trim().length > 0) {
        const span = document.createElement('span');
        span.className = 'hl';
        span.textContent = node.textContent;
        return span;
      }
      return node;
    }
    
    if (node.nodeType === Node.ELEMENT_NODE) {
      const isBlock = window.getComputedStyle(node).display.includes('block') ||
        ['P', 'H1', 'H2', 'H3', 'H4', 'DIV'].includes(node.tagName);
      
      const wrapper = isBlock ? document.createElement(node.tagName.toLowerCase()) : document.createElement('span');
      wrapper.className = isBlock ? node.className + ' hl' : 'hl';
      
      Array.from(node.attributes).forEach(attr => {
        wrapper.setAttribute(attr.name, attr.value);
      });
      
      while (node.firstChild) {
        const processedChild = processNode(node.firstChild);
        wrapper.appendChild(processedChild);
      }
      
      return wrapper;
    }
    
    return node;
  }
  
  const highlightedContent = processNode(div);
  lastRange.deleteContents();
  lastRange.insertNode(highlightedContent);
  
  selbar.style.display = 'none';
  showToast('Highlighted');
}

function removeHighlight() {
  if (currentHlNode) {
    const parent = currentHlNode.parentNode;
    while (currentHlNode.firstChild) {
      parent.insertBefore(currentHlNode.firstChild, currentHlNode);
    }
    parent.removeChild(currentHlNode);
    parent.normalize();
    currentHlNode = null;
    selbar.style.display = 'none';
    showToast('Highlight removed');
    return;
  }
  
  if (!lastRange) return;
  
  const selRect = lastRange.getBoundingClientRect();
  const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_ELEMENT);
  const toRemove = [];
  
  while (walker.nextNode()) {
    const node = walker.currentNode;
    if (node.classList && node.classList.contains('hl')) {
      const rect = node.getBoundingClientRect();
      if (!(rect.right < selRect.left || rect.left > selRect.right ||
        rect.bottom < selRect.top || rect.top > selRect.bottom)) {
        toRemove.push(node);
      }
    }
  }
  
  toRemove.forEach(el => {
    const parent = el.parentNode;
    while (el.firstChild) {
      parent.insertBefore(el.firstChild, el);
    }
    parent.removeChild(el);
    parent.normalize();
  });
  
  selbar.style.display = 'none';
  showToast('Highlight removed');
}

btnHL.addEventListener('click', doHighlight);
btnUH.addEventListener('click', removeHighlight);

// Á¨îËÆ∞ÂäüËÉΩ
var notes = document.getElementById('notes');
var noteArea = document.getElementById('noteArea');
var btnCopy = document.getElementById('btnCopy');
var btnClose = document.getElementById('btnClose');

function toggleNotes() {
  notes.style.display = (notes.style.display === 'flex' ? 'none' : 'flex');
}
window.toggleNotes = toggleNotes;

btnClose.addEventListener('click', toggleNotes);
btnCopy.addEventListener('click', async function() {
  await navigator.clipboard.writeText(noteArea.value || '');
  showToast('Copied');
});

btnNote.addEventListener('click', function() {
  var text = '';
  if (currentHlNode) {
    text = (currentHlNode.textContent || '').trim();
  } else if (lastRange) {
    var frag = lastRange.cloneContents();
    text = (frag.textContent || '').trim();
  }
  toggleNotes();
  if (text) {
    noteArea.value = (noteArea.value ? noteArea.value + '\n' : '') + '> ' + text + '\n';
  }
  selbar.style.display = 'none';
});

// Á≠îÈ¢òÁä∂ÊÄÅÊõ¥Êñ∞
function updateAnswerStatus() {
  for (let i = 14; i <= 26; i++) {
    const inputs = document.querySelectorAll(`input[name="q${i}"]`);
    const navItem = document.getElementById(`q${i}-nav`);
    if (navItem) {
      let answered = false;
      inputs.forEach(input => {
        if ((input.type === 'radio' || input.type === 'checkbox') && input.checked) {
          answered = true;
        } else if (input.type === 'text' && input.value.trim()) {
          answered = true;
        }
      });
      if (answered) {
        navItem.classList.add('answered');
      } else {
        navItem.classList.remove('answered');
      }
    }
  }
}

// Á≠îÊ°àÂíåËØÑÂàÜÁ≥ªÁªü
var answers = {
  "q14": "F", "q15": "E", "q16": "C", "q17": "D", "q18": "B", "q19": "A", "q20": "G",
  "q21": "TRUE", "q22": "TRUE", "q23": "TRUE", "q24": "FALSE", "q25": "TRUE", "q26": "TRUE"
};

function grade() {
  var total = 0, correct = 0, lines = [];
  
  // Ê£ÄÊü•ÂçïÈÄâÈ¢ò (14-26)
  for (let n = 14; n <= 26; n++) {
    const q = `q${n}`;
    total++;
    const selected = document.querySelector(`input[name="${q}"]:checked`);
    const userAnswer = selected ? selected.value : '';
    const isCorrect = userAnswer === answers[q];
    if (isCorrect) correct++;
    lines.push(`${q.toUpperCase()}: ${userAnswer || 'None'} ${isCorrect ? '‚úì' : '‚úó'}`);
  }
  
  // ÊòæÁ§∫ÁªìÊûú
  const acc = Math.round(100 * correct / total);
  document.getElementById('results').innerHTML = `
    <p><strong>Score:</strong> ${correct}/${total} <span class="badge">Accuracy ${acc}%</span></p>
    <pre>${lines.join('\n')}</pre>
  `;
  
  // ÊòæÁ§∫Á≠îÊ°à
  document.getElementById('answerContent').innerHTML = `
    <ol>
      <li>14 ‚Üí F</li>
      <li>15 ‚Üí E</li>
      <li>16 ‚Üí C</li>
      <li>17 ‚Üí D</li>
      <li>18 ‚Üí B</li>
      <li>19 ‚Üí A</li>
      <li>20 ‚Üí G</li>
      <li>21 ‚Üí TRUE</li>
      <li>22 ‚Üí TRUE</li>
      <li>23 ‚Üí TRUE</li>
      <li>24 ‚Üí FALSE</li>
      <li>25 ‚Üí TRUE</li>
      <li>26 ‚Üí TRUE</li>
    </ol>
  `;
  document.querySelector('#answerBox .badge').textContent = 'tap to view';
  
  updateAnswerStatus();
}

// ÁõëÂê¨Á≠îÊ°àÂèòÂåñ
document.addEventListener('change', updateAnswerStatus);
document.addEventListener('input', updateAnswerStatus);

// È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
document.addEventListener('DOMContentLoaded', function() {
  startTimer();
  updateAnswerStatus(); // ÂàùÂßãÂåñÁ≠îÈ¢òÁä∂ÊÄÅ
  
  // Âä†ËΩΩ‰øùÂ≠òÁöÑ‰∏ªÈ¢ò
  if (localStorage.getItem('darkMode') === 'true') {
    document.body.classList.add('dark');
    document.querySelector('.theme-toggle').textContent = '‚òÄÔ∏è';
  }
});

// ÁªÉ‰π†È°µÈù¢Â¢ûÂº∫ËÑöÊú¨ÈõÜÊàê
function loadPracticePageEnhancer() {
  const script = document.createElement('script');
  script.src = '../../../js/practice-page-enhancer.js';
  script.onload = function() {
    console.log('ÁªÉ‰π†È°µÈù¢Â¢ûÂº∫ËÑöÊú¨Â∑≤Âä†ËΩΩ');
      };
  script.onerror = function() {
    console.error('ÁªÉ‰π†È°µÈù¢Â¢ûÂº∫ËÑöÊú¨Âä†ËΩΩÂ§±Ë¥•');
    // ÈôçÁ∫ßÂà∞ÂÜÖËÅîÂ¢ûÂº∫
    loadInlineEnhancer();
  };
  document.head.appendChild(script);
}

// ÂÜÖËÅîÂ¢ûÂº∫Âô®ÔºàÈôçÁ∫ßÊñπÊ°àÔºâ
function loadInlineEnhancer() {
  if (window.practicePageEnhancer) return;
  
  window.practicePageEnhancer = {
    initialize: function() {
      console.log('[InlineEnhancer] ÂÜÖËÅîÂ¢ûÂº∫Âô®Â∑≤ÂàùÂßãÂåñ');
          this.setupCommunication();
      this.setupAnswerListeners();
      this.interceptSubmit();
    },
    
    setupCommunication: function() {
      this.parentWindow = window.opener || window.parent;
      window.addEventListener('message', (event) => {
        if (event.data && event.data.type === 'INIT_SESSION') {
          this.sessionId = event.data.data.sessionId;
          this.sendMessage('SESSION_READY', {
            pageType: this.detectPageType(),
            url: window.location.href
          });
        }
      });
    },
    
    detectPageType: function() {
      const title = document.title || '';
      if (title.includes('P1')) return 'P1';
      if (title.includes('P2')) return 'P2';
      if (title.includes('P3')) return 'P3';
      return 'unknown';
    },
    
    setupAnswerListeners: function() {
      this.answers = {};
      this.startTime = Date.now();
      
      document.addEventListener('change', (e) => {
        if (e.target.name && e.target.name.startsWith('q')) {
          this.answers[e.target.name] = e.target.value;
        }
      });
      
      document.addEventListener('input', (e) => {
        if (e.target.name && e.target.name.startsWith('q')) {
          this.answers[e.target.name] = e.target.value;
        }
      });
    },
    
    interceptSubmit: function() {
      // Êã¶Êà™gradeÂáΩÊï∞
      if (typeof window.grade === 'function') {
        const originalGrade = window.grade;
        window.grade = () => {
          const result = originalGrade();
          setTimeout(() => this.handleSubmit(), 200);
          return result;
        };
      }
      
      // ÁõëÂê¨Êèê‰∫§ÊåâÈíÆ
      document.addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON' &&
          (e.target.textContent.includes('Submit') ||
            e.target.onclick && e.target.onclick.toString().includes('grade'))) {
          setTimeout(() => this.handleSubmit(), 300);
        }
      });
    },
    
    handleSubmit: function() {
      const results = {
        sessionId: this.sessionId,
        startTime: this.startTime,
        endTime: Date.now(),
        duration: Math.round((Date.now() - this.startTime) / 1000),
        answers: this.answers,
        scoreInfo: this.extractScore(),
        pageType: this.detectPageType(),
        url: window.location.href
      };
      
      this.sendMessage('PRACTICE_COMPLETE', results);
    },
    
    extractScore: function() {
      const resultsEl = document.getElementById('results');
      if (!resultsEl) return null;
      
      const text = resultsEl.textContent || '';
      const scoreMatch = text.match(/Score:\s*(\d+)\/(\d+)/i);
      if (scoreMatch) {
        const correct = parseInt(scoreMatch[1]);
        const total = parseInt(scoreMatch[2]);
        return {
          correct: correct,
          total: total,
          accuracy: total > 0 ? correct / total : 0,
          percentage: Math.round((correct / total) * 100),
          source: 'inline_extraction'
        };
      }
      return null;
    },
    
    sendMessage: function(type, data) {
      if (this.parentWindow) {
        this.parentWindow.postMessage({
          type: type,
          data: data,
          source: 'practice_page'
        }, '*');
      }
    }
  };
  
  // ÂàùÂßãÂåñ
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      window.practicePageEnhancer.initialize();
    });
  } else {
    window.practicePageEnhancer.initialize();
  }
}

// Âä†ËΩΩÂ¢ûÂº∫ËÑöÊú¨
loadPracticePageEnhancer();
</script>

</body>
</html>